{"version":3,"file":"pages_search_restaurant_index-page.mjs","sources":["../../../pages/search/restaurant/ModalGroup/EditDeleteNotifyModal/EditDeleteNotifyModal.tsx","../../../pages/search/restaurant/ModalGroup/ModalGroup.tsx","../../../pages/search/restaurant/index.page.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAppDispatch, useAppSelector } from '../../../../../renderer/store/hooks';\r\nimport { navigate } from 'vite-plugin-ssr/client/router';\r\nimport { EDIT_DELETE_NOTIFY_MODAL } from '../../../../../renderer/_reducers/_slices/reviewSlice';\r\nimport { API_URL } from '../../../../../renderer/CONSTANT_URL';\r\n\r\nexport { EditDeleteNotifyModal };\r\n\r\nfunction EditDeleteNotifyModal() {\r\n    const [show, setShow] = useState(false);\r\n    const editDeleteNotifyModalOn = useAppSelector((state) => state.reviewSlice.editDeleteNotifyModalOn);\r\n    const sameUserOwner = useAppSelector((state) => state.reviewSlice.sameUserOwner);\r\n\r\n    useEffect(() => {\r\n        if (editDeleteNotifyModalOn === true) setShow(true);\r\n        else setShow(false);\r\n    }, [editDeleteNotifyModalOn]);\r\n\r\n    return (\r\n        <article className={`modal-edit-delete-notify ${show ? 'on' : ''}`}>\r\n            <h4 className=\"sr-only\">ÏàòÏ†ï, ÏÇ≠Ï†ú, Ïã†Í≥†Ïö© Î™®Îã¨</h4>\r\n            <ul>\r\n                {sameUserOwner ? (\r\n                    <>\r\n                        <EDIT />\r\n                        <DELETE />\r\n                    </>\r\n                ) : (\r\n                    <li> üö® Ïã†Í≥†ÌïòÍ∏∞</li>\r\n                )}\r\n            </ul>\r\n        </article>\r\n    );\r\n}\r\n\r\nfunction EDIT() {\r\n    const dispatch = useAppDispatch();\r\n    const reviewId = useAppSelector((state) => state.reviewSlice.reviewId);\r\n    const restaurantId = useAppSelector((state) => state.reviewSlice.restaurantId);\r\n\r\n    function handleClick() {\r\n        navigate(`/search/${restaurantId}/reviews/${reviewId}/edit`);\r\n        const app = document.querySelector('.app');\r\n        app?.classList.remove('modal-mode');\r\n        dispatch(EDIT_DELETE_NOTIFY_MODAL(false));\r\n    }\r\n\r\n    return <li onClick={handleClick}>ü©π ÏàòÏ†ïÌïòÍ∏∞</li>;\r\n}\r\n\r\nfunction DELETE() {\r\n    const dispatch = useAppDispatch();\r\n    const reviewId = useAppSelector((state) => state.reviewSlice.reviewId);\r\n    const restaurantId = useAppSelector((state) => state.reviewSlice.restaurantId);\r\n\r\n    async function handleClick() {\r\n        try {\r\n            const res = await fetch(`${API_URL}/reviews/${reviewId}`, {\r\n                credentials: 'include',\r\n                method: 'DELETE',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({ restaurantId: restaurantId }),\r\n            });\r\n            const data = await res.json();\r\n            if (data.success) {\r\n                navigate(`/search/${restaurantId}`);\r\n            } else {\r\n                alert('Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n        } finally {\r\n            const app = document.querySelector('.app');\r\n            app?.classList.remove('modal-mode');\r\n            dispatch(EDIT_DELETE_NOTIFY_MODAL(false));\r\n        }\r\n    }\r\n    return <li onClick={handleClick}>üóëÔ∏è ÏÇ≠Ï†úÌïòÍ∏∞</li>;\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useAppDispatch, useAppSelector } from '../../../../renderer/store/hooks';\r\nimport { EDIT_DELETE_NOTIFY_MODAL } from '../../../../renderer/_reducers/_slices/reviewSlice';\r\nimport { EditDeleteNotifyModal } from './EditDeleteNotifyModal/EditDeleteNotifyModal';\r\n\r\nexport { ModalGroup };\r\n\r\nfunction ModalGroup() {\r\n    const on = useAppSelector((state) => state.reviewSlice.editDeleteNotifyModalOn);\r\n    const [show, setShow] = useState(false);\r\n\r\n    const dispatch = useAppDispatch();\r\n\r\n    useEffect(() => {\r\n        if (on === true) setShow(true);\r\n        else setShow(false);\r\n    }, [on]);\r\n\r\n    useEffect(() => {\r\n        if (show) {\r\n            document.addEventListener('click', handleClose);\r\n        }\r\n\r\n        return () => {\r\n            document.removeEventListener('click', handleClose);\r\n        };\r\n    }, [show]);\r\n\r\n    function handleClose(event: MouseEvent) {\r\n        if ((event.target as HTMLElement).className === 'app modal-mode') {\r\n            const app = document.querySelector('.app');\r\n            app?.classList.remove('modal-mode');\r\n\r\n            dispatch(EDIT_DELETE_NOTIFY_MODAL(false));\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className={`modal-group ${show ? 'on' : ''}`}>\r\n            <EditDeleteNotifyModal />\r\n        </div>\r\n    );\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport { TopBar } from '../../../components/topBar/topBar';\r\nimport { NavBar } from '../../../components/navBar';\r\nimport { ModalGroup } from './ModalGroup/ModalGroup';\r\nimport { API_URL } from '../../../renderer/CONSTANT_URL';\r\nimport { useCheckLoginStatus } from '../../../renderer/_hooks/useCheckLoginStatus';\r\nimport LoadingMain from '../../../components/Loading/LoadingMain';\r\nimport type { PageContext } from '../../../renderer/types';\r\nimport type { Restaurant } from '../../../server/models/Restaurant';\r\n\r\nconst RestaurantDetail = React.lazy(() => import('./RestaurantDetail/RestaurantDetail'));\r\n\r\nexport { Page };\r\n\r\nfunction Page(pageContext: PageContext) {\r\n    const { routeParams } = pageContext;\r\n\r\n    const [isLoggedIn, userInfo] = useCheckLoginStatus();\r\n    const restaurantId = pageContext.routeParams?.restaurantId || '';\r\n\r\n    const [restaurantInfo, setRestaurantInfo] = useState<Restaurant | null>(null);\r\n\r\n    useEffect(() => {\r\n        getRestaurantList();\r\n    }, [routeParams]);\r\n\r\n    async function getRestaurantList() {\r\n        const res = await fetch(`${API_URL}/restaurants/${restaurantId}`, {\r\n            headers: {\r\n                'Cache-Control': 's-maxage=2678400, max-age=0',\r\n            },\r\n        });\r\n        const data = (await res.json()) as { success: boolean; restaurantInfo: Restaurant; totalReview: number };\r\n\r\n        if (data.success) {\r\n            setRestaurantInfo(data.restaurantInfo);\r\n        }\r\n    }\r\n    return (\r\n        <>\r\n            <TopBar title=\"ÏÉÅÏÑ∏Ï†ïÎ≥¥\" />\r\n            <React.Suspense fallback={<LoadingMain />}>\r\n                <RestaurantDetail restaurantInfo={restaurantInfo} isLoggedIn={isLoggedIn} userInfo={userInfo} />\r\n            </React.Suspense>\r\n            <NavBar isLoggedIn={isLoggedIn} />\r\n            <ModalGroup />\r\n        </>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}