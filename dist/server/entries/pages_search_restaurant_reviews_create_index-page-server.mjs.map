{"version":3,"file":"pages_search_restaurant_reviews_create_index-page-server.mjs","sources":["../../../pages/search/restaurant/reviews/create/index.page.server.ts"],"sourcesContent":["import fetch from 'node-fetch';\r\nimport type { PageContext } from '../../../../../renderer/types';\r\nimport type { Restaurant } from '../../../../../server/models/Restaurant';\r\n\r\ntype Params = {\r\n    restaurantId: string;\r\n};\r\n\r\nexport { onBeforeRender };\r\n\r\nasync function onBeforeRender(pageContext: PageContext) {\r\n    const { restaurantId } = pageContext.routeParams as Params;\r\n\r\n    const res = await fetch(\r\n        `${\r\n            process.env.NODE_ENV === 'production' ? 'https://api.green-maps.site/v1' : 'https://localhost:5000/v1'\r\n        }/restaurants/${restaurantId}`,\r\n        {\r\n            headers: {\r\n                'Cache-Control': 'max-age=31536000',\r\n            },\r\n        }\r\n    );\r\n\r\n    const data = (await res.json()) as { success: boolean; restaurantInfo: Restaurant };\r\n\r\n    if (data.success) {\r\n        return {\r\n            pageContext: {\r\n                restaurantInfo: data.restaurantInfo,\r\n            },\r\n        };\r\n    } else {\r\n        return {\r\n            pageContext: {\r\n                restaurantInfo: {},\r\n            },\r\n        };\r\n    }\r\n}\r\n"],"names":[],"mappings":";AAUA,eAAe,eAAe,aAA0B;AAC9C,QAAA,EAAE,aAAa,IAAI,YAAY;AAErC,QAAM,MAAM,MAAM;AAAA,IACd,GACI,QAAQ,IAAI,aAAa,eAAe,mCAAmC,2CAC/D;AAAA,IAChB;AAAA,MACI,SAAS;AAAA,QACL,iBAAiB;AAAA,MACrB;AAAA,IACJ;AAAA,EAAA;AAGE,QAAA,OAAQ,MAAM,IAAI;AAExB,MAAI,KAAK,SAAS;AACP,WAAA;AAAA,MACH,aAAa;AAAA,QACT,gBAAgB,KAAK;AAAA,MACzB;AAAA,IAAA;AAAA,EACJ,OACG;AACI,WAAA;AAAA,MACH,aAAa;AAAA,QACT,gBAAgB,CAAC;AAAA,MACrB;AAAA,IAAA;AAAA,EAER;AACJ;"}