{"version":3,"file":"pages_search_restaurant_reviews_edit_index-page.mjs","sources":["../../../pages/search/restaurant/reviews/edit/index.page.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { TopBar } from '../../../../../components/topBar/topBar';\r\nimport { ReviewForm } from '../create/ReviewForm/ReviewForm';\r\nimport { useCheckLoginStatus } from '../../../../../renderer/_hooks/useCheckLoginStatus';\r\nimport { API_URL } from '../../../../../renderer/CONSTANT_URL';\r\nimport LoadingMain from '../../../../../components/Loading/LoadingMain';\r\nimport type { PageContext } from '../../../../../renderer/types';\r\nimport type { Restaurant } from '../../../../../server/models/Restaurant';\r\nimport type { Review } from '../../../../../server/models/Review';\r\n\r\nexport const documentProps = {\r\n    title: '리뷰 수정 | Green Maps',\r\n    description: '채식 식당 리뷰 수정 페이지',\r\n};\r\n\r\nexport { Page };\r\n\r\nfunction Page(pageContext: PageContext) {\r\n    const restaurantId = pageContext.routeParams?.restaurantId || '';\r\n    const reviewId = pageContext.routeParams?.reviewId || '';\r\n\r\n    const [restaurant, setRestaurant] = useState<Restaurant | null>(null);\r\n    const [review, setReview] = useState<Review | null>(null);\r\n\r\n    const [_, userInfo] = useCheckLoginStatus();\r\n\r\n    useEffect(() => {\r\n        getMyReview().then((data) => {\r\n            if (data.success) {\r\n                setReview(data.review);\r\n                setRestaurant(typeof data.review.restaurant === 'object' ? data.review.restaurant : null);\r\n            } else {\r\n                setReview(null);\r\n                setRestaurant(null);\r\n            }\r\n        });\r\n    }, []);\r\n\r\n    async function getMyReview() {\r\n        const res = await fetch(`${API_URL}/reviews/${reviewId}`);\r\n        const data = (await res.json()) as { success: boolean; review: Review };\r\n\r\n        return data;\r\n    }\r\n    return (\r\n        <React.Suspense fallback={<LoadingMain />}>\r\n            <TopBar title=\"리뷰 수정\" />\r\n            {review && restaurant && (\r\n                <ReviewForm\r\n                    restaurantId={restaurantId}\r\n                    reviewId={reviewId}\r\n                    title={restaurant.title}\r\n                    photos={review.photo}\r\n                    content={review.content}\r\n                    userInfo={userInfo}\r\n                />\r\n            )}\r\n        </React.Suspense>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAUO,MAAM,gBAAgB;AAAA,EACzB,OAAO;AAAA,EACP,aAAa;AACjB;AAIA,SAAS,KAAK,aAA0B;;AAC9B,QAAA,iBAAe,iBAAY,gBAAZ,mBAAyB,iBAAgB;AACxD,QAAA,aAAW,iBAAY,gBAAZ,mBAAyB,aAAY;AAEtD,QAAM,CAAC,YAAY,aAAa,IAAI,SAA4B,IAAI;AACpE,QAAM,CAAC,QAAQ,SAAS,IAAI,SAAwB,IAAI;AAExD,QAAM,CAAC,GAAG,QAAQ,IAAI,oBAAoB;AAE1C,YAAU,MAAM;AACA,gBAAA,EAAE,KAAK,CAAC,SAAS;AACzB,UAAI,KAAK,SAAS;AACd,kBAAU,KAAK,MAAM;AACP,sBAAA,OAAO,KAAK,OAAO,eAAe,WAAW,KAAK,OAAO,aAAa,IAAI;AAAA,MAAA,OACrF;AACH,kBAAU,IAAI;AACd,sBAAc,IAAI;AAAA,MACtB;AAAA,IAAA,CACH;AAAA,EACL,GAAG,CAAE,CAAA;AAEL,iBAAe,cAAc;AACzB,UAAM,MAAM,MAAM,MAAM,GAAG,mBAAmB,UAAU;AAClD,UAAA,OAAQ,MAAM,IAAI;AAEjB,WAAA;AAAA,EACX;AACA,8BACK,MAAM,UAAN,EAAe,UAAU,oBAAC,eAAY,GACnC,UAAA;AAAA,IAAC,oBAAA,QAAA,EAAO,OAAM,QAAQ,CAAA;AAAA,IACrB,UAAU,cACP;AAAA,MAAC;AAAA,MAAA;AAAA,QACG;AAAA,QACA;AAAA,QACA,OAAO,WAAW;AAAA,QAClB,QAAQ,OAAO;AAAA,QACf,SAAS,OAAO;AAAA,QAChB;AAAA,MAAA;AAAA,IACJ;AAAA,EAER,EAAA,CAAA;AAER;"}