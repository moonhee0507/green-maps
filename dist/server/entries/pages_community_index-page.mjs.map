{"version":3,"file":"pages_community_index-page.mjs","sources":["../../../pages/community/SearchForm.tsx","../../../pages/community/SearchBar.tsx","../../../pages/community/index.page.tsx"],"sourcesContent":["import React, { useRef, useState } from 'react';\r\n\r\nexport { SearchForm };\r\n\r\nfunction SearchForm() {\r\n    const [showInput, setShowInput] = useState<boolean>(false);\r\n\r\n    const inputElement = useRef<HTMLInputElement>(null);\r\n\r\n    function moveToPage(): void {\r\n        if (inputElement.current !== null) {\r\n            const keyword = inputElement.current.value;\r\n            if (keyword.length > 0) {\r\n                const url = `/community/search/${keyword}`;\r\n                // navigate(url, { keepScrollPosition: true });\r\n                window.location.href = url;\r\n            } else {\r\n                window.alert('Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className=\"search-bar\">\r\n                <div>\r\n                    {showInput ? (\r\n                        <div>\r\n                            <label htmlFor=\"searchItem\" className=\"sr-only\">\r\n                                Í≤åÏãúÍ∏Ä Í≤ÄÏÉâÌïòÍ∏∞\r\n                            </label>\r\n                            <input type=\"search\" id=\"searchItem\" ref={inputElement} autoFocus />\r\n                        </div>\r\n                    ) : (\r\n                        <h2 className=\"top-title\">Í≤åÏãúÌåê</h2>\r\n                    )}\r\n                </div>\r\n            </div>\r\n            <button\r\n                type=\"button\"\r\n                onClick={() => (showInput ? moveToPage() : setShowInput(true))}\r\n                aria-label=\"Í≤åÏãúÍ∏Ä Í≤ÄÏÉâ Î≤ÑÌäº\"\r\n            >\r\n                üîç\r\n            </button>\r\n        </>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport { ButtonGoBack } from '../../components/button/buttonGoBack';\r\nimport { SearchForm } from './SearchForm';\r\n\r\nexport { SearchBar };\r\n\r\nfunction SearchBar() {\r\n    return (\r\n        <div className=\"top-bar search\">\r\n            <ButtonGoBack />\r\n            <SearchForm />\r\n        </div>\r\n    );\r\n}\r\n","import React, { useCallback, useEffect, useState } from 'react';\r\nimport { SearchBar } from './SearchBar';\r\nimport { NavBar } from '../../components/navBar';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useAppSelector } from '../../renderer/store/hooks';\r\nimport { API_URL } from '../../renderer/CONSTANT_URL';\r\nimport { useCheckLoginStatus } from '../../renderer/_hooks/useCheckLoginStatus';\r\nimport LoadingMain from '../../components/Loading/LoadingMain';\r\nimport type { PageContext } from '../../renderer/types';\r\nimport type { Post } from '../../server/models/Post';\r\n\r\nconst CommunityMain = React.lazy(() => import('./CommunityMain'));\r\n\r\nexport function Page(pageContext: PageContext) {\r\n    const [isLoggedIn, _] = useCheckLoginStatus();\r\n\r\n    // Ï†ÑÏó≠ÏóêÏÑú Í¥ÄÎ¶¨ÌïòÎäî Î≥ÄÏàò: subject Îì±Î°ù Ïó¨Î∂Ä, ÌòÑÏû¨ ÌéòÏù¥ÏßÄ, ÌïúÌéòÏù¥ÏßÄÎãπ ÏµúÎåÄÍ≤åÏãúÎ¨º Ïàò\r\n    const subject = useAppSelector((state) => state.postSlice.SUBJECT);\r\n    const currentPage = useAppSelector((state) => state.postSlice.post.CURRENT_PAGE);\r\n\r\n    const limit = 20;\r\n\r\n    // ÎÇ¥Î†§Î≥¥ÎÇ¥Îäî Îç∞Ïù¥ÌÑ∞Îäî Ïó¨Í∏∞ÏÑú Ï†ïÌï¥Ïßê\r\n    const [posts, setPosts] = useState<Array<Post>>(pageContext.pageProps?.postProps?.lists || []);\r\n\r\n    const getPosts = useCallback(async () => {\r\n        try {\r\n            // ÎßêÎ®∏Î¶¨Ïóê ÎÇ¥Ïö©Ïù¥ ÏûàÏúºÎ©¥ subjects/:name, ÏïÑÎãàÎ©¥ posts\r\n            const res = await fetch(\r\n                `${API_URL}/${subject !== '' ? 'subjects/' + subject : 'posts'}?page=${currentPage}&limit=${limit}`,\r\n                {\r\n                    credentials: 'include',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    },\r\n                }\r\n            );\r\n\r\n            const data = await res.json();\r\n\r\n            return data;\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    }, [currentPage, subject]); // ÌòÑÏû¨ ÌéòÏù¥ÏßÄ Î∞îÎÄåÎ©¥ ÏÉà Í≤åÏãúÎ¨º Í∞ÄÏ†∏Ïò§Í∏∞ + ÎßêÎ®∏Î¶¨ Î∞îÎÄåÎ©¥ ÏÉà Í≤åÏãúÎ¨º Í∞ÄÏ†∏Ïò§Í∏∞\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        getPosts().then((data: any) => {\r\n            setPosts(data.currentPage === 1 ? data.lists : [...posts, ...data.lists]); // Í≤åÏãúÎ¨ºÎì§ÏùÄ ÎÇ¥Î†§Î≥¥ÎÉÑ\r\n            // ÌòÑÏû¨ ÌéòÏù¥ÏßÄ\r\n            dispatch({\r\n                type: 'postSlice/POST_IN_PAGE',\r\n                TOTAL: data.total,\r\n                CURRENT_PAGE: data.currentPage,\r\n            });\r\n        });\r\n    }, [getPosts]);\r\n\r\n    return (\r\n        <React.Suspense fallback={<LoadingMain />}>\r\n            <SearchBar />\r\n            <CommunityMain isLoggedIn={isLoggedIn} posts={posts} limit={limit} />\r\n            <NavBar isLoggedIn={isLoggedIn} />\r\n        </React.Suspense>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;AAIA,SAAS,aAAa;AAClB,QAAM,CAAC,WAAW,YAAY,IAAI,SAAkB,KAAK;AAEnD,QAAA,eAAe,OAAyB,IAAI;AAElD,WAAS,aAAmB;AACpB,QAAA,aAAa,YAAY,MAAM;AACzB,YAAA,UAAU,aAAa,QAAQ;AACjC,UAAA,QAAQ,SAAS,GAAG;AACpB,cAAM,MAAM,qBAAqB;AAEjC,eAAO,SAAS,OAAO;AAAA,MAAA,OACpB;AACH,eAAO,MAAM,cAAc;AAAA,MAC/B;AAAA,IACJ;AAAA,EACJ;AAEA,SAEQ,qBAAA,UAAA,EAAA,UAAA;AAAA,IAAA,oBAAC,SAAI,WAAU,cACX,8BAAC,OACI,EAAA,UAAA,iCACI,OACG,EAAA,UAAA;AAAA,MAAA,oBAAC,SAAM,EAAA,SAAQ,cAAa,WAAU,WAAU,UAEhD,YAAA;AAAA,MACA,oBAAC,WAAM,MAAK,UAAS,IAAG,cAAa,KAAK,cAAc,WAAS,KAAC,CAAA;AAAA,IAAA,EAAA,CACtE,IAEC,oBAAA,MAAA,EAAG,WAAU,aAAY,UAAA,MAAA,CAAG,EAErC,CAAA,GACJ;AAAA,IACA;AAAA,MAAC;AAAA,MAAA;AAAA,QACG,MAAK;AAAA,QACL,SAAS,MAAO,YAAY,WAAW,IAAI,aAAa,IAAI;AAAA,QAC5D,cAAW;AAAA,QACd,UAAA;AAAA,MAAA;AAAA,IAED;AAAA,EACJ,EAAA,CAAA;AAER;ACzCA,SAAS,YAAY;AAEb,SAAA,qBAAC,OAAI,EAAA,WAAU,kBACX,UAAA;AAAA,IAAA,oBAAC,cAAa,EAAA;AAAA,wBACb,YAAW,EAAA;AAAA,EAChB,EAAA,CAAA;AAER;ACFA,MAAM,gBAAgB,MAAM,KAAK,MAAM,OAAO,6BAAiB,CAAC;AAEzD,SAAS,KAAK,aAA0B;;AAC3C,QAAM,CAAC,YAAY,CAAC,IAAI,oBAAoB;AAG5C,QAAM,UAAU,eAAe,CAAC,UAAU,MAAM,UAAU,OAAO;AACjE,QAAM,cAAc,eAAe,CAAC,UAAU,MAAM,UAAU,KAAK,YAAY;AAE/E,QAAM,QAAQ;AAGR,QAAA,CAAC,OAAO,QAAQ,IAAI,WAAsB,uBAAY,cAAZ,mBAAuB,cAAvB,mBAAkC,UAAS,CAAA,CAAE;AAEvF,QAAA,WAAW,YAAY,YAAY;AACjC,QAAA;AAEA,YAAM,MAAM,MAAM;AAAA,QACd,GAAG,WAAW,YAAY,KAAK,cAAc,UAAU,gBAAgB,qBAAqB;AAAA,QAC5F;AAAA,UACI,aAAa;AAAA,UACb,SAAS;AAAA,YACL,gBAAgB;AAAA,UACpB;AAAA,QACJ;AAAA,MAAA;AAGE,YAAA,OAAO,MAAM,IAAI;AAEhB,aAAA;AAAA,aACF;AACL,cAAQ,MAAM,GAAG;AAAA,IACrB;AAAA,EAAA,GACD,CAAC,aAAa,OAAO,CAAC;AAEzB,QAAM,WAAW;AAEjB,YAAU,MAAM;AACH,aAAA,EAAE,KAAK,CAAC,SAAc;AAClB,eAAA,KAAK,gBAAgB,IAAI,KAAK,QAAQ,CAAC,GAAG,OAAO,GAAG,KAAK,KAAK,CAAC;AAE/D,eAAA;AAAA,QACL,MAAM;AAAA,QACN,OAAO,KAAK;AAAA,QACZ,cAAc,KAAK;AAAA,MAAA,CACtB;AAAA,IAAA,CACJ;AAAA,EAAA,GACF,CAAC,QAAQ,CAAC;AAEb,8BACK,MAAM,UAAN,EAAe,UAAU,oBAAC,eAAY,GACnC,UAAA;AAAA,IAAA,oBAAC,WAAU,EAAA;AAAA,IACV,oBAAA,eAAA,EAAc,YAAwB,OAAc,MAAc,CAAA;AAAA,IACnE,oBAAC,UAAO,YAAwB;AAAA,EACpC,EAAA,CAAA;AAER;"}