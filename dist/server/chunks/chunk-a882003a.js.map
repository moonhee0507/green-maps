{"version":3,"file":"chunk-a882003a.js","sources":["../../../renderer/_hooks/useCheckLoginStatus.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { API_URL } from '../CONSTANT_URL';\r\nimport { UserInfo } from '../../server/models/User';\r\n\r\ntype IsLoggedIn = boolean;\r\ntype User = UserInfo | null;\r\n\r\nexport { useCheckLoginStatus };\r\n\r\nfunction useCheckLoginStatus(): [IsLoggedIn, User] {\r\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n    const [userInfo, setUserInfo] = useState<UserInfo | null>(null);\r\n\r\n    useEffect(() => {\r\n        const checkLoginStatus = async () => {\r\n            try {\r\n                const res = await fetch(`${API_URL}/users/`, {\r\n                    credentials: 'include',\r\n                    method: 'GET',\r\n                });\r\n                const data = (await res.json()) as { success: boolean; user: UserInfo };\r\n\r\n                if (data.success === true) {\r\n                    setIsLoggedIn(true);\r\n                    setUserInfo(data.user);\r\n                } else {\r\n                    setIsLoggedIn(false);\r\n                    setUserInfo(null);\r\n                }\r\n\r\n                redirect(data.success);\r\n            } catch (error) {\r\n                setIsLoggedIn(false);\r\n                setUserInfo(null);\r\n\r\n                redirect(false);\r\n            }\r\n        };\r\n\r\n        checkLoginStatus();\r\n    }, []);\r\n\r\n    return [isLoggedIn, userInfo];\r\n}\r\n\r\nfunction redirect(isLoggedIn: boolean): void {\r\n    if (!isLoggedIn) {\r\n        if (window.location.pathname === '/my') {\r\n            window.location.href = '/login';\r\n        }\r\n\r\n        if (window.location.pathname === '/my-lists') {\r\n            window.location.href = '/login';\r\n        }\r\n    } else {\r\n        if (window.location.pathname === '/signup' || window.location.pathname === '/login') {\r\n            window.location.href = '/search';\r\n        }\r\n    }\r\n}\r\n"],"names":[],"mappings":";;AASA,SAAS,sBAA0C;AAC/C,QAAM,CAAC,YAAY,aAAa,IAAI,SAAS,KAAK;AAClD,QAAM,CAAC,UAAU,WAAW,IAAI,SAA0B,IAAI;AAE9D,YAAU,MAAM;AACZ,UAAM,mBAAmB,YAAY;AAC7B,UAAA;AACA,cAAM,MAAM,MAAM,MAAM,GAAG,kBAAkB;AAAA,UACzC,aAAa;AAAA,UACb,QAAQ;AAAA,QAAA,CACX;AACK,cAAA,OAAQ,MAAM,IAAI;AAEpB,YAAA,KAAK,YAAY,MAAM;AACvB,wBAAc,IAAI;AAClB,sBAAY,KAAK,IAAI;AAAA,QAAA,OAClB;AACH,wBAAc,KAAK;AACnB,sBAAY,IAAI;AAAA,QACpB;AAEA,iBAAS,KAAK,OAAO;AAAA,eAChB;AACL,sBAAc,KAAK;AACnB,oBAAY,IAAI;AAEhB,iBAAS,KAAK;AAAA,MAClB;AAAA,IAAA;AAGa;EACrB,GAAG,CAAE,CAAA;AAEE,SAAA,CAAC,YAAY,QAAQ;AAChC;AAEA,SAAS,SAAS,YAA2B;AACzC,MAAI,CAAC,YAAY;AACT,QAAA,OAAO,SAAS,aAAa,OAAO;AACpC,aAAO,SAAS,OAAO;AAAA,IAC3B;AAEI,QAAA,OAAO,SAAS,aAAa,aAAa;AAC1C,aAAO,SAAS,OAAO;AAAA,IAC3B;AAAA,EAAA,OACG;AACH,QAAI,OAAO,SAAS,aAAa,aAAa,OAAO,SAAS,aAAa,UAAU;AACjF,aAAO,SAAS,OAAO;AAAA,IAC3B;AAAA,EACJ;AACJ;"}