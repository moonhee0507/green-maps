{"version":3,"file":"pages_login_index.page.52b2f1c9.js","sources":["../../../../../../../../../images/icon-kakao.webp","../../../../pages/login/LoginMain/SelectStage.tsx","../../../../pages/login/LoginMain/IdStage.tsx","../../../../pages/login/LoginMain/PasswordStage.tsx","../../../../pages/login/LoginMain/LoginMain.tsx","../../../../pages/login/index.page.tsx"],"sourcesContent":["export default \"__VITE_PUBLIC_ASSET__95e4d656__\"","import React, { useEffect, useState } from 'react';\r\nimport { useAppDispatch } from '../../../renderer/store/hooks';\r\nimport { LOGGING_IN } from '../../../renderer/_reducers/_slices/loginSlice';\r\nimport { Link } from '../../../renderer/Link';\r\nimport { API_URL } from '../../../renderer/CONSTANT_URL';\r\nimport imgKakao from '/images/icon-kakao.webp';\r\n\r\nexport { SelectStage };\r\n\r\nfunction SelectStage({ setMove }: { setMove: React.Dispatch<React.SetStateAction<number>> }) {\r\n    const [popup, setPopup] = useState<Window | null>(null);\r\n\r\n    const dispatch = useAppDispatch();\r\n\r\n    const nextStage = () => {\r\n        setMove(-100);\r\n        dispatch(LOGGING_IN(true));\r\n    };\r\n\r\n    const callAgreementScreen = () => {\r\n        const width = 500;\r\n        const height = 700;\r\n        const left = window.screenX + (window.outerWidth - width) / 2;\r\n        const top = window.screenY + (window.outerHeight - height) / 2;\r\n\r\n        const kakaoPopup = window.open(\r\n            `${API_URL}/oauth/kakao`,\r\n            'kakao_popup',\r\n            `width=${width},height=${height},left=${left},top=${top}`\r\n        );\r\n\r\n        setPopup(kakaoPopup);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (!popup) return;\r\n\r\n        const timer = setInterval(() => {\r\n            if (!popup) {\r\n                timer && clearInterval(timer);\r\n\r\n                return;\r\n            }\r\n\r\n            const popupUrl = popup.location.href;\r\n            if (!popupUrl) return;\r\n\r\n            const searchParams = new URL(popupUrl).searchParams;\r\n            const authorizeCode = searchParams.get('code');\r\n\r\n            if (authorizeCode) {\r\n                popup.close();\r\n                getAccessTokenFromKakao(authorizeCode).then((data) => {\r\n                    if (data.success) {\r\n                        getKakaoUserData().then((data) => {\r\n                            if (data.success) {\r\n                                window.location.href = '/my';\r\n                            } else {\r\n                                console.error(`카카오 사용자 데이터 가져오기 실패`);\r\n                            }\r\n                        });\r\n                    } else {\r\n                        console.error(`카카오 API 토큰 요청에 실패했습니다.`);\r\n                    }\r\n                });\r\n            }\r\n        }, 500);\r\n    }, [popup]);\r\n\r\n    async function getAccessTokenFromKakao(authorizeCode: string) {\r\n        const res = await fetch(`${API_URL}/oauth/kakao/token?code=${authorizeCode}`, {\r\n            credentials: 'include',\r\n            method: 'GET',\r\n        });\r\n        const data = await res.json();\r\n\r\n        return data;\r\n    }\r\n\r\n    async function getKakaoUserData() {\r\n        const res = await fetch(`${API_URL}/oauth/kakao/users`, {\r\n            credentials: 'include',\r\n            method: 'GET',\r\n        });\r\n        const data = await res.json();\r\n\r\n        return data;\r\n    }\r\n\r\n    return (\r\n        <section className=\"login-select-stage\">\r\n            <h3 className=\"sr-only\">로그인 방식 선택</h3>\r\n            <div className=\"container-rocket\">\r\n                <span>🚀</span>\r\n            </div>\r\n            <button type=\"button\" onClick={nextStage} className=\"styled-button reuse-in-login\">\r\n                로그인\r\n            </button>\r\n            <button type=\"button\" className=\"styled-button kakao-login\" onClick={callAgreementScreen}>\r\n                <img src={imgKakao} alt=\"카카오 아이콘\" role=\"presentation\" />\r\n                <span>카카오 로그인</span>\r\n            </button>\r\n            <Link href=\"/signup\" className=\"link-to-signup\">\r\n                회원가입\r\n            </Link>\r\n        </section>\r\n    );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { useAppDispatch } from '../../../renderer/store/hooks';\r\nimport { LOGGING_IN, SET_ID } from '../../../renderer/_reducers/_slices/loginSlice';\r\n\r\nexport { IdStage };\r\n\r\nfunction IdStage({ setMove }: { setMove: React.Dispatch<React.SetStateAction<number>> }) {\r\n    const dispatch = useAppDispatch();\r\n    const [id, setId] = useState('');\r\n\r\n    const handlePrev = () => {\r\n        setMove((prev) => prev + 100);\r\n        dispatch(LOGGING_IN(false));\r\n    };\r\n\r\n    const handleNext = () => {\r\n        setMove((prev) => prev - 100);\r\n        dispatch(SET_ID(id));\r\n    };\r\n\r\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        setId(event.target.value);\r\n    };\r\n\r\n    return (\r\n        <section className=\"login-id-stage\">\r\n            <h3 className=\"sr-only\">아이디 입력</h3>\r\n            <label htmlFor=\"loginId\">아이디</label>\r\n            <input type=\"text\" id=\"loginId\" onChange={handleChange} />\r\n            <div className=\"button-group-move\">\r\n                <button type=\"button\" onClick={handlePrev} aria-label=\"이전 화면으로 이동\">\r\n                    첫 화면\r\n                </button>\r\n                <button type=\"button\" onClick={handleNext} aria-label=\"다음 화면으로 이동\">\r\n                    비밀번호\r\n                </button>\r\n            </div>\r\n        </section>\r\n    );\r\n}\r\n","import React, { ChangeEvent, useState } from 'react';\r\nimport { useAppDispatch, useAppSelector } from '../../../renderer/store/hooks';\r\nimport { LOGGING_IN } from '../../../renderer/_reducers/_slices/loginSlice';\r\nimport { API_URL } from '../../../renderer/CONSTANT_URL';\r\n\r\nexport { PasswordStage };\r\n\r\nfunction PasswordStage({ setMove }: { setMove: React.Dispatch<React.SetStateAction<number>> }) {\r\n    const dispatch = useAppDispatch();\r\n\r\n    const id = useAppSelector((state) => state.loginSlice.currentId);\r\n    const [password, setPassword] = useState<string>('');\r\n    const [isChecked, setIsChecked] = useState<boolean>(false);\r\n\r\n    const handlePrev = () => {\r\n        setMove((prev) => prev + 100);\r\n    };\r\n\r\n    const handlePasswordChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n        setPassword(event.target.value);\r\n    };\r\n    const handleCheckChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n        setIsChecked(event.target.checked);\r\n    };\r\n\r\n    async function handleClick() {\r\n        // 톱바의 뒤로가기 보여줘도 됨\r\n        dispatch(LOGGING_IN(false));\r\n\r\n        // 로그인 통신\r\n        try {\r\n            const body = new URLSearchParams();\r\n            body.append('userId', id);\r\n            body.append('password', password);\r\n            body.append('keepLogin', isChecked ? 'true' : 'false');\r\n\r\n            const res = await fetch(`${API_URL}/users/login`, {\r\n                credentials: 'include',\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/x-www-form-urlencoded',\r\n                },\r\n                body: body.toString(),\r\n            });\r\n\r\n            const data = await res.json();\r\n\r\n            if (data.success) {\r\n                window.alert('🎉🎉로그인에 성공했습니다🎉🎉');\r\n                window.location.href = '/search';\r\n            } else {\r\n                window.alert('로그인에 실패했습니다');\r\n            }\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <section className=\"login-password-stage\">\r\n            <h3 className=\"sr-only\">비밀번호 입력</h3>\r\n\r\n            <label htmlFor=\"loginPassword\">비밀번호</label>\r\n            <input type=\"password\" id=\"loginPassword\" onChange={handlePasswordChange} />\r\n\r\n            <label htmlFor=\"loginPersist\">로그인 유지</label>\r\n            <input type=\"checkbox\" id=\"loginPersist\" onChange={handleCheckChange} />\r\n\r\n            <div className=\"button-group-move\">\r\n                <button type=\"button\" onClick={handlePrev} aria-label=\"이전 화면으로 이동\">\r\n                    아이디\r\n                </button>\r\n                <button type=\"button\" onClick={handleClick} aria-label=\"다음 화면으로 이동\">\r\n                    로그인\r\n                </button>\r\n            </div>\r\n        </section>\r\n    );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { SelectStage } from './SelectStage';\r\nimport { IdStage } from './IdStage';\r\nimport { PasswordStage } from './PasswordStage';\r\n\r\nexport { LoginMain };\r\n\r\nfunction LoginMain() {\r\n    const [move, setMove] = useState(0);\r\n\r\n    return (\r\n        <main className=\"main-login\">\r\n            <div className=\"login-stage-wrapper\" style={{ left: `${move}%`, transition: '.5s' }}>\r\n                <SelectStage setMove={setMove} />\r\n                <IdStage setMove={setMove} />\r\n                <PasswordStage setMove={setMove} />\r\n            </div>\r\n        </main>\r\n    );\r\n}\r\n","import React from 'react';\r\nimport { TopBar } from '../../components/topBar/topBar';\r\nimport { LoginMain } from './LoginMain/LoginMain';\r\nimport { useCheckLoginStatus } from '../../renderer/_hooks/useCheckLoginStatus';\r\n\r\nexport const documentProps = {\r\n    title: '로그인 | Green Maps',\r\n    description: '채식 식당 지도 서비스 로그인',\r\n};\r\n\r\nexport { Page };\r\n\r\nfunction Page() {\r\n    useCheckLoginStatus();\r\n\r\n    return (\r\n        <>\r\n            <TopBar title={'로그인'} />\r\n            <LoginMain />\r\n        </>\r\n    );\r\n}\r\n"],"names":["imgKakao","SelectStage","setMove","popup","setPopup","useState","dispatch","useAppDispatch","nextStage","LOGGING_IN","callAgreementScreen","left","top","kakaoPopup","API_URL","useEffect","timer","popupUrl","authorizeCode","getAccessTokenFromKakao","data","getKakaoUserData","jsxs","jsx","Link","IdStage","id","setId","handlePrev","prev","handleNext","SET_ID","handleChange","event","PasswordStage","useAppSelector","state","password","setPassword","isChecked","setIsChecked","handlePasswordChange","handleCheckChange","handleClick","body","err","LoginMain","move","documentProps","Page","useCheckLoginStatus","Fragment","TopBar"],"mappings":"oYAAA,MAAeA,EAAA,0BCSf,SAASC,EAAY,CAAE,QAAAC,GAAsE,CACzF,KAAM,CAACC,EAAOC,CAAQ,EAAIC,WAAwB,IAAI,EAEhDC,EAAWC,IAEXC,EAAY,IAAM,CACpBN,EAAQ,IAAI,EACHI,EAAAG,EAAW,EAAI,CAAC,CAAA,EAGvBC,EAAsB,IAAM,CAG9B,MAAMC,EAAO,OAAO,SAAW,OAAO,WAAa,KAAS,EACtDC,EAAM,OAAO,SAAW,OAAO,YAAc,KAAU,EAEvDC,EAAa,OAAO,KACtB,GAAGC,gBACH,cACA,6BAAwCH,SAAYC,GAAA,EAGxDR,EAASS,CAAU,CAAA,EAGvBE,EAAAA,UAAU,IAAM,CACZ,GAAI,CAACZ,EAAO,OAEN,MAAAa,EAAQ,YAAY,IAAM,CAC5B,GAAI,CAACb,EAAO,CACRa,GAAS,cAAcA,CAAK,EAE5B,OAGE,MAAAC,EAAWd,EAAM,SAAS,KAChC,GAAI,CAACc,EAAU,OAGT,MAAAC,EADe,IAAI,IAAID,CAAQ,EAAE,aACJ,IAAI,MAAM,EAEzCC,IACAf,EAAM,MAAM,EACZgB,EAAwBD,CAAa,EAAE,KAAME,GAAS,CAC9CA,EAAK,QACYC,EAAA,EAAE,KAAMD,GAAS,CAC1BA,EAAK,QACL,OAAO,SAAS,KAAO,MAEvB,QAAQ,MAAM,qBAAqB,CACvC,CACH,EAED,QAAQ,MAAM,wBAAwB,CAC1C,CACH,IAEN,GAAG,CAAA,EACP,CAACjB,CAAK,CAAC,EAEV,eAAegB,EAAwBD,EAAuB,CAOnD,OAFM,MAJD,MAAM,MAAM,GAAGJ,4BAAkCI,IAAiB,CAC1E,YAAa,UACb,OAAQ,KAAA,CACX,GACsB,MAG3B,CAEA,eAAeG,GAAmB,CAOvB,OAFM,MAJD,MAAM,MAAM,GAAGP,sBAA6B,CACpD,YAAa,UACb,OAAQ,KAAA,CACX,GACsB,MAG3B,CAGI,OAAAQ,EAAA,KAAC,UAAQ,CAAA,UAAU,qBACf,SAAA,CAACC,EAAA,IAAA,KAAA,CAAG,UAAU,UAAU,SAAS,YAAA,QAChC,MAAI,CAAA,UAAU,mBACX,SAACA,MAAA,OAAA,CAAK,cAAE,CACZ,CAAA,EACAA,EAAAA,IAAC,UAAO,KAAK,SAAS,QAASf,EAAW,UAAU,+BAA+B,SAEnF,KAAA,CAAA,SACC,SAAO,CAAA,KAAK,SAAS,UAAU,4BAA4B,QAASE,EACjE,SAAA,CAAAa,MAAC,OAAI,IAAKvB,EAAU,IAAI,UAAU,KAAK,eAAe,EACtDuB,EAAAA,IAAC,QAAK,SAAO,SAAA,CAAA,CAAA,EACjB,QACCC,EAAK,CAAA,KAAK,UAAU,UAAU,iBAAiB,SAEhD,OAAA,CACJ,CAAA,CAAA,CAER,CCrGA,SAASC,EAAQ,CAAE,QAAAvB,GAAsE,CACrF,MAAMI,EAAWC,IACX,CAACmB,EAAIC,CAAK,EAAItB,WAAS,EAAE,EAEzBuB,EAAa,IAAM,CACb1B,EAAC2B,GAASA,EAAO,GAAG,EACnBvB,EAAAG,EAAW,EAAK,CAAC,CAAA,EAGxBqB,EAAa,IAAM,CACb5B,EAAC2B,GAASA,EAAO,GAAG,EACnBvB,EAAAyB,EAAOL,CAAE,CAAC,CAAA,EAGjBM,EAAgBC,GAA+C,CAC3DN,EAAAM,EAAM,OAAO,KAAK,CAAA,EAIxB,OAAAX,EAAA,KAAC,UAAQ,CAAA,UAAU,iBACf,SAAA,CAACC,EAAA,IAAA,KAAA,CAAG,UAAU,UAAU,SAAM,SAAA,EAC7BA,EAAA,IAAA,QAAA,CAAM,QAAQ,UAAU,SAAG,MAAA,QAC3B,QAAM,CAAA,KAAK,OAAO,GAAG,UAAU,SAAUS,EAAc,EACxDV,EAAAA,KAAC,MAAI,CAAA,UAAU,oBACX,SAAA,CAAAC,EAAAA,IAAC,UAAO,KAAK,SAAS,QAASK,EAAY,aAAW,aAAa,SAEnE,MAAA,CAAA,EACAL,EAAAA,IAAC,UAAO,KAAK,SAAS,QAASO,EAAY,aAAW,aAAa,SAEnE,MAAA,CAAA,CAAA,EACJ,CACJ,CAAA,CAAA,CAER,CChCA,SAASI,EAAc,CAAE,QAAAhC,GAAsE,CAC3F,MAAMI,EAAWC,IAEXmB,EAAKS,EAAgBC,GAAUA,EAAM,WAAW,SAAS,EACzD,CAACC,EAAUC,CAAW,EAAIjC,WAAiB,EAAE,EAC7C,CAACkC,EAAWC,CAAY,EAAInC,WAAkB,EAAK,EAEnDuB,EAAa,IAAM,CACb1B,EAAC2B,GAASA,EAAO,GAAG,CAAA,EAG1BY,EAAwBR,GAAyC,CACvDK,EAAAL,EAAM,OAAO,KAAK,CAAA,EAE5BS,EAAqBT,GAAyC,CACnDO,EAAAP,EAAM,OAAO,OAAO,CAAA,EAGrC,eAAeU,GAAc,CAEhBrC,EAAAG,EAAW,EAAK,CAAC,EAGtB,GAAA,CACM,MAAAmC,EAAO,IAAI,gBACZA,EAAA,OAAO,SAAUlB,CAAE,EACnBkB,EAAA,OAAO,WAAYP,CAAQ,EAChCO,EAAK,OAAO,YAAaL,EAAY,OAAS,OAAO,GAWxC,MATD,MAAM,MAAM,GAAGzB,gBAAuB,CAC9C,YAAa,UACb,OAAQ,OACR,QAAS,CACL,eAAgB,mCACpB,EACA,KAAM8B,EAAK,SAAS,CAAA,CACvB,GAEsB,QAEd,SACL,OAAO,MAAM,qBAAqB,EAClC,OAAO,SAAS,KAAO,WAEvB,OAAO,MAAM,aAAa,QAEzBC,GACL,QAAQ,MAAMA,CAAG,CACrB,CACJ,CAGI,OAAAvB,EAAA,KAAC,UAAQ,CAAA,UAAU,uBACf,SAAA,CAACC,EAAA,IAAA,KAAA,CAAG,UAAU,UAAU,SAAO,UAAA,EAE9BA,EAAA,IAAA,QAAA,CAAM,QAAQ,gBAAgB,SAAI,OAAA,QAClC,QAAM,CAAA,KAAK,WAAW,GAAG,gBAAgB,SAAUkB,EAAsB,EAEzElB,EAAA,IAAA,QAAA,CAAM,QAAQ,eAAe,SAAM,SAAA,QACnC,QAAM,CAAA,KAAK,WAAW,GAAG,eAAe,SAAUmB,EAAmB,EAEtEpB,EAAAA,KAAC,MAAI,CAAA,UAAU,oBACX,SAAA,CAAAC,EAAAA,IAAC,UAAO,KAAK,SAAS,QAASK,EAAY,aAAW,aAAa,SAEnE,KAAA,CAAA,EACAL,EAAAA,IAAC,UAAO,KAAK,SAAS,QAASoB,EAAa,aAAW,aAAa,SAEpE,KAAA,CAAA,CAAA,EACJ,CACJ,CAAA,CAAA,CAER,CCvEA,SAASG,GAAY,CACjB,KAAM,CAACC,EAAM7C,CAAO,EAAIG,WAAS,CAAC,EAElC,OACKkB,EAAA,IAAA,OAAA,CAAK,UAAU,aACZ,gBAAC,MAAI,CAAA,UAAU,sBAAsB,MAAO,CAAE,KAAM,GAAGwB,KAAS,WAAY,KACxE,EAAA,SAAA,CAAAxB,MAACtB,GAAY,QAAAC,EAAkB,EAC/BqB,MAACE,GAAQ,QAAAvB,EAAkB,EAC3BqB,MAACW,GAAc,QAAAhC,EAAkB,CAAA,CACrC,CAAA,CACJ,CAAA,CAER,CCdO,MAAM8C,EAAgB,CACzB,MAAO,mBACP,YAAa,kBACjB,EAIA,SAASC,GAAO,CACQ,OAAAC,IAIZ5B,EAAA,KAAA6B,WAAA,CAAA,SAAA,CAAC5B,EAAAA,IAAA6B,EAAA,CAAO,MAAO,KAAO,CAAA,QACrBN,EAAU,EAAA,CACf,CAAA,CAAA,CAER"}