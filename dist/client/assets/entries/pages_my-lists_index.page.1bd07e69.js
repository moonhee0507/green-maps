import{j as t,r as l}from"../chunks/chunk-0ad0329c.js";import{T as b}from"../chunks/chunk-d4e38713.js";import{N as y}from"../chunks/chunk-5b1b7faa.js";import{L as k,M as L}from"../chunks/chunk-07d61ebb.js";import{b as p,c as h,A as g}from"../chunks/chunk-0fac4abb.js";import{S,A as v,O as N,D as w}from"../chunks/chunk-dcab5b34.js";import{n as O}from"../chunks/chunk-c949b376.js";import{u as D}from"../chunks/chunk-8a644018.js";import"../chunks/chunk-da345742.js";import"../chunks/chunk-41308c4f.js";import"../chunks/chunk-3c838518.js";import"../chunks/chunk-e8bc0b58.js";import"../chunks/chunk-2e5a4929.js";import"../chunks/chunk-9ae07e36.js";import"../chunks/chunk-ce871bab.js";import"../chunks/chunk-255b6daf.js";import"../chunks/chunk-2b326172.js";import"../chunks/chunk-f3107ac8.js";import"../chunks/chunk-a5dd79e5.js";import"../chunks/chunk-63b910cd.js";import"../chunks/chunk-370f01b3.js";import"../chunks/chunk-c4e4febb.js";import"../chunks/chunk-af981888.js";function E({userInfo:n}){const{bookmarkList:e,likeList:s}=n,i=p(c=>c.myListSlice.clicked),o=h();function r(c){var d;const m=(d=c.currentTarget.lastElementChild)==null?void 0:d.innerHTML;typeof m=="string"&&o(S(m))}return t.jsxs("ul",{className:"ul-summary-bookmark",children:[t.jsxs("li",{onClick:r,className:`list-summary-bookmark ${i==="북마크"?"on":""}`,children:[t.jsx("p",{children:n&&e?e.length:0}),t.jsx("p",{children:"북마크"})]}),t.jsxs("li",{onClick:r,className:`list-summary-bookmark ${i==="좋아요"?"on":""}`,children:[t.jsx("p",{children:n&&s?s.length:0}),t.jsx("p",{children:"좋아요"})]})]})}function f({groupInfo:n,lists:e}){const{name:s,registeredAt:i,groupIcon:o}=n,[r]=l.useState(i.slice(0,13)),[c,m]=l.useState(0);return l.useEffect(()=>{if(e.length===0&&m(0),e.length>0){const d=e.filter(a=>a.groupName===s);m(d.length)}},[]),t.jsx("li",{className:"li-bookmarkgroup",children:t.jsx("a",{href:`/my-lists/bookmark/${s}`,children:t.jsxs("div",{className:"style-wrapper-groupname",children:[t.jsxs("div",{className:"style-wrapper-groupname-info",children:[t.jsx("div",{className:"container-groupicon",children:t.jsx("img",{src:o,alt:"그룹 아이콘",style:{width:"100%",height:"100%"}})}),t.jsxs("div",{children:[t.jsx("p",{className:"txt-groupname",children:s}),t.jsxs("p",{className:"txt-restaurant-count",children:["개수 ",t.jsx("span",{className:"num-restaurant-count",children:c})]})]})]}),t.jsx("div",{className:"txt-group-date",children:r})]})})})}function C({lists:n,groupList:e}){const[s,i]=l.useState(null),[o,r]=l.useState(null);l.useEffect(()=>{e&&(i(e),r([...e].sort((a,u)=>a.name.localeCompare(u.name,"en"))))},[e]);const c=p(a=>a.myListSlice.groupNameOrder),m=h();function d(){const a=document.querySelector(".app");a==null||a.classList.add("modal-mode"),m(v(!0))}return e!==null?t.jsxs(t.Fragment,{children:[t.jsx("ul",{className:"ul-groupname",children:c==="등록순"?s==null?void 0:s.map(a=>t.jsx(f,{groupInfo:a,lists:n},Math.random())):o==null?void 0:o.map(a=>t.jsx(f,{groupInfo:a,lists:n},Math.random()))}),t.jsx("button",{type:"button",className:"button-new-group",onClick:d,children:"새 그룹 추가"})]}):t.jsxs("div",{className:"style-wrapper-no-review",children:[t.jsx("div",{className:"txt-no-review",children:"🚀"}),t.jsx("p",{children:"로딩중"})]})}function M({lists:n}){const[e,s]=l.useState([]),[i,o]=l.useState([]),[r,c]=l.useState([]);l.useEffect(()=>{(async()=>{const u=[];for(const x of n)try{const j=await d(x._id);u.push(Object.assign(x,j))}catch{console.error("북마크 그룹에 저장된 식당 _id에 대한 정보를 가져오는 데 실패했습니다.")}s(u)})()},[]);const m=p(a=>a.myListSlice.groupNameOrder);l.useEffect(()=>{e.length!==0&&(o(e),c([...e].sort((a,u)=>a.restaurantInfo.title.localeCompare(u.restaurantInfo.title,"en"))))},[e]);async function d(a){return await(await fetch(`${g}/restaurants/${a}`)).json()}return e&&e.length>0?t.jsx("ul",{className:"ul-groupname",children:m==="등록순"?i.map(a=>t.jsx(k,{list:a},Math.random())):r.map(a=>t.jsx(k,{list:a},Math.random()))}):t.jsxs("div",{className:"style-wrapper-no-review",children:[t.jsx("div",{className:"txt-no-review",children:"😭"}),t.jsx("p",{children:"목록이 없어요."})]})}function A({lists:n,groupList:e}){const s=p(c=>c.myListSlice.groupNameOrder),i=h();function o(){const c=document.querySelector(".app");c==null||c.classList.add("modal-mode"),i(N(!0))}function r(){O("/my-lists/bookmark/edit")}return t.jsxs("div",{className:"style-wrapper-bookmark-detail",children:[t.jsxs("div",{className:"wrapper-groupcount-orderbox",children:[t.jsxs("p",{className:"txt-bookmarkgroup",children:["그룹 ",t.jsx("span",{children:(e==null?void 0:e.length)||1})]}),t.jsx("div",{className:"container-order-bookmarkgroup",children:t.jsx("button",{type:"button",className:"button-order-bookmarkgroup",onClick:o,children:s})})]}),t.jsx("button",{type:"button",className:"button-edit-bookmarkgroup",onClick:r,children:"편집하기"})]})}function R({lists:n}){const e=p(r=>r.myListSlice.groupNameOrder),s=h();function i(){const r=document.querySelector(".app");r==null||r.classList.add("modal-mode"),s(N(!0))}function o(){const r=document.querySelector(".app");r==null||r.classList.add("modal-mode"),s(w(!0))}return t.jsxs("div",{className:"style-wrapper-bookmark-detail",children:[t.jsxs("div",{className:"wrapper-groupcount-orderbox",children:[t.jsxs("p",{className:"txt-bookmarkgroup",children:["전체 ",t.jsx("span",{children:n.length})]}),t.jsx("div",{className:"container-order-bookmarkgroup",children:t.jsx("button",{type:"button",className:"button-order-bookmarkgroup",onClick:i,children:e})})]}),t.jsx("button",{type:"button",className:"button-edit-bookmarkgroup",onClick:o,children:"편집하기"})]})}function I({userInfo:n,groupList:e}){const{bookmarkList:s,likeList:i}=n,o=p(r=>r.myListSlice.clicked);return t.jsxs("section",{className:"section-mylists",children:[t.jsx("h3",{className:"sr-only",children:"북마크 또는 좋아요한 식당 목록"}),o==="북마크"?t.jsx(A,{lists:s,groupList:e}):t.jsx(R,{lists:i}),o==="북마크"?t.jsx(C,{lists:s,groupList:e}):t.jsx(M,{lists:i})]})}function nt(n){const[e,s]=D(),[i,o]=l.useState(null);return l.useEffect(()=>{if(s)try{(async()=>{const c=await(await fetch(`${g}/bookmark/${s==null?void 0:s.userId}`)).json();o(c.groupList)})()}catch(r){console.error(r)}},[s]),t.jsxs(t.Fragment,{children:[t.jsx(b,{title:"내 식당 목록"}),t.jsx(_,{userInfo:s,groupList:i}),t.jsx(y,{isLoggedIn:e}),t.jsx(L,{userInfo:s})]})}function _({userInfo:n,groupList:e}){return t.jsxs("main",{className:"main-bookmark",children:[t.jsx(E,{userInfo:n}),t.jsx(I,{userInfo:n,groupList:e})]})}export{nt as Page};
