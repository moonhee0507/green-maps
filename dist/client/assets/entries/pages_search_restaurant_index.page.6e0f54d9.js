import{_ as j}from"../chunks/chunk-101896b7.js";import{r as n,j as s,R as h}from"../chunks/chunk-0ad0329c.js";import{T as w}from"../chunks/chunk-7393fde3.js";import{N as E}from"../chunks/chunk-5b1b7faa.js";import{b as i,c as d,A as p}from"../chunks/chunk-0fac4abb.js";import{E as u}from"../chunks/chunk-2b326172.js";import{n as v}from"../chunks/chunk-c949b376.js";import"../chunks/chunk-da345742.js";import"../chunks/chunk-41308c4f.js";import"../chunks/chunk-3c838518.js";import"../chunks/chunk-af981888.js";function I(){const[t,r]=n.useState(!1),a=i(e=>e.reviewSlice.editDeleteNotifyModalOn),o=i(e=>e.reviewSlice.sameUserOwner);return n.useEffect(()=>{r(a===!0)},[a]),s.jsxs("article",{className:`modal-edit-delete-notify ${t?"on":""}`,children:[s.jsx("h4",{className:"sr-only",children:"수정, 삭제, 신고용 모달"}),s.jsx("ul",{children:o?s.jsxs(s.Fragment,{children:[s.jsx(S,{}),s.jsx(x,{})]}):s.jsx("li",{children:" 🚨 신고하기"})})]})}function S(){const t=d(),r=i(e=>e.reviewSlice.reviewId),a=i(e=>e.reviewSlice.restaurantId);function o(){v(`/search/${a}/reviews/${r}/edit`);const e=document.querySelector(".app");e==null||e.classList.remove("modal-mode"),t(u(!1))}return s.jsx("li",{onClick:o,children:"🩹 수정하기"})}function x(){const t=d(),r=i(e=>e.reviewSlice.reviewId),a=i(e=>e.reviewSlice.restaurantId);async function o(){try{(await(await fetch(`${p}/reviews/${r}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({restaurantId:a})})).json()).success?v(`/search/${a}`):alert("다시 시도해주세요.")}catch(e){console.error(e)}finally{const e=document.querySelector(".app");e==null||e.classList.remove("modal-mode"),t(u(!1))}}return s.jsx("li",{onClick:o,children:"🗑️ 삭제하기"})}function y(){const t=i(c=>c.reviewSlice.editDeleteNotifyModalOn),[r,a]=n.useState(!1),o=d();n.useEffect(()=>{a(t===!0)},[t]),n.useEffect(()=>(r&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}),[r]);function e(c){if(c.target.className==="app modal-mode"){const l=document.querySelector(".app");l==null||l.classList.remove("modal-mode"),o(u(!1))}}return s.jsx("div",{className:`modal-group ${r?"on":""}`,children:s.jsx(I,{})})}const L=h.lazy(()=>j(()=>import("../chunks/chunk-932000b5.js"),["assets/chunks/chunk-932000b5.js","assets/chunks/chunk-0ad0329c.js","assets/chunks/chunk-da345742.js","assets/chunks/chunk-0fac4abb.js","assets/chunks/chunk-c949b376.js","assets/chunks/chunk-af981888.js","assets/chunks/chunk-9ae07e36.js","assets/chunks/chunk-32ec8ef6.js","assets/chunks/chunk-96ebd7d3.js","assets/chunks/chunk-dfbf6de9.js","assets/chunks/chunk-2b326172.js","assets/chunks/chunk-41308c4f.js","assets/chunks/chunk-1b57fcb1.js"]));function q(t){var f;const{routeParams:r,user:a}=t,o=((f=t.routeParams)==null?void 0:f.restaurantId)||"",[e,c]=n.useState(null);n.useEffect(()=>{l()},[r]);async function l(){const m=await(await fetch(`${p}/restaurants/${o}`,{headers:{"Cache-Control":"max-age=31536000"}})).json();m.success&&c(m.restaurantInfo)}return s.jsxs(s.Fragment,{children:[s.jsx(w,{title:"상세정보"}),s.jsx(h.Suspense,{fallback:s.jsx(D,{}),children:s.jsx(L,{restaurantInfo:e,isLoggedIn:t.user?t.user.isLoggedIn:!1,userInfo:t.user?t.user.info:null})}),s.jsx(E,{isLoggedIn:t.user?t.user.isLoggedIn:!1}),s.jsx(y,{})]})}function D(){return s.jsx("div",{children:"로딩중..."})}export{q as Page};
