import{r,j as e}from"../chunks/chunk-0ad0329c.js";import{T as f}from"../chunks/chunk-d225a41f.js";import{u as c}from"../chunks/chunk-da345742.js";import{n as R}from"../chunks/chunk-c949b376.js";import{a,A as E}from"../chunks/chunk-97cf9c75.js";import{P as C}from"../chunks/chunk-a9cc629c.js";import"../chunks/chunk-41308c4f.js";import"../chunks/chunk-af981888.js";import"../chunks/chunk-b82a1d50.js";import"../chunks/chunk-4a7b83e5.js";import"../chunks/chunk-dfbf6de9.js";function g(){const n=c(i=>i.postSlice.KEYWORD),s=r.useRef(null);function o(){var l;const i=`/community/search/${(l=s.current)==null?void 0:l.value}`;R(i,{keepScrollPosition:!0})}return e.jsxs("div",{className:"container-search-input",children:[e.jsx("label",{htmlFor:"communitySearchResult",className:"sr-only",children:"ê²Œì‹œê¸€ ê²€ìƒ‰í•˜ê¸°"}),e.jsx("input",{type:"search",id:"communitySearchResult",ref:s,defaultValue:n}),e.jsx("button",{onClick:o,children:"ê²€ìƒ‰"})]})}function v(){const n=a();function s(o){n({type:"postSlice/SUBJECT_STATE",SUBJECT:o==null?void 0:o.target.value})}return e.jsxs("div",{className:"container-search-select",children:[e.jsx("label",{htmlFor:"communitySearchSelect",className:"sr-only",children:"ë§ë¨¸ë¦¬ ì„ íƒ"}),e.jsxs("select",{name:"subjects",id:"communitySearchSelect",onChange:s,children:[e.jsx("option",{value:"",children:"ì „ì²´ ê²Œì‹œíŒ"}),e.jsx("option",{value:"ê³µì§€ì‚¬í•­",children:"ê³µì§€ì‚¬í•­"}),e.jsx("option",{value:"ðŸ¥‘ì±„ì‹ì–˜ê¸°",children:"ðŸ¥‘ì±„ì‹ì–˜ê¸°"}),e.jsx("option",{value:"âš½ìš´ë™ì–˜ê¸°",children:"âš½ìš´ë™ì–˜ê¸°"})]})]})}function B(){return e.jsxs("div",{children:[e.jsx(g,{}),e.jsx(v,{})]})}function b(){const n=a();function s(o){n({type:"postSlice/SEARCH_POOL",BOUNDARY:o.target.value})}return e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"boundarySelect",children:"ë²”ìœ„"}),e.jsxs("select",{id:"boundarySelect",onChange:s,children:[e.jsx("option",{value:"tc",children:"ì œëª©+ë‚´ìš©"}),e.jsx("option",{value:"t",children:"ì œëª©"}),e.jsx("option",{value:"c",children:"ë‚´ìš©"}),e.jsx("option",{value:"n",children:"ê¸€ìž‘ì„±ìž"})]})]})}function P(){const n=a();function s(o){n({type:"postSlice/SEARCH_ORDER",ORDERBY:o.target.value})}return e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"orderBySelect",children:"ì •ë ¬"}),e.jsxs("select",{id:"orderBySelect",onChange:s,children:[e.jsx("option",{value:"latest",children:"ìµœì‹ ìˆœ"}),e.jsx("option",{value:"accuracy",children:"ì •í™•ë„"}),e.jsx("option",{value:"comment",children:"ëŒ“ê¸€"})]})]})}function T(){return e.jsxs("div",{children:[e.jsx(b,{}),e.jsx(P,{})]})}function O(){const n=c(s=>s.postSlice.post.TOTAL);return e.jsxs("div",{className:"result-community-detail",children:[e.jsx("p",{className:"txt-total-search",children:e.jsxs("span",{children:[n||0,"ê±´"]})}),e.jsx(T,{})]})}function A(){return e.jsxs("div",{style:{position:"sticky",top:0},children:[e.jsx(B,{}),e.jsx(O,{})]})}function N(n){const{posts:s,limit:o}=n;return e.jsxs("section",{children:[e.jsx("h3",{className:"sr-only",children:"ê²€ìƒ‰ê²°ê³¼"}),e.jsx(C,{posts:s,limit:o})]})}function J(n){var S;const s=a();s({type:"postSlice/SEARCH",KEYWORD:((S=n.routeParams)==null?void 0:S.keyword)||""});const[o,i]=r.useState(n.postInfo.lists),[l,y]=r.useState(!1);r.useEffect(()=>{typeof l<"u"&&y(!0)},[]);const u=c(t=>t.postSlice.KEYWORD),p=c(t=>t.postSlice.SUBJECT),d=c(t=>t.postSlice.post.CURRENT_PAGE),h=c(t=>t.postSlice.BOUNDARY),m=c(t=>t.postSlice.ORDERBY),x=20,j=r.useCallback(async()=>{try{return await(await fetch(`${E}/posts?keyword=${u}&subject=${encodeURIComponent(p)}&page=${d}&limit=${x}&boundary=${h}&orderby=${m}`,{headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error(t)}},[u,p,d,h,m]);return r.useEffect(()=>{j().then(t=>{i(t.currentPage===1?t.lists:[...o,...t.lists]),s({type:"postSlice/POST_IN_PAGE",TOTAL:t.total,CURRENT_PAGE:t.currentPage})})},[j]),e.jsxs(e.Fragment,{children:[e.jsx(f,{title:"ê²€ìƒ‰ ê²°ê³¼"}),l&&e.jsx(D,{posts:o,limit:x})]})}function D(n){const{posts:s,limit:o}=n;return e.jsxs("main",{className:"community-search-main",children:[e.jsx(A,{}),e.jsx(N,{posts:s,limit:o})]})}export{J as Page};
