import{j as e,r as l}from"../chunks/chunk-0ad0329c.js";import{T as b}from"../chunks/chunk-2af108cb.js";import{N as y}from"../chunks/chunk-5b1b7faa.js";import{L as k,M as L}from"../chunks/chunk-00f5a23b.js";import{a as p,u as h,A as N}from"../chunks/chunk-8f8abf42.js";import{S,A as v,O as g,D as w}from"../chunks/chunk-dcab5b34.js";import{n as O}from"../chunks/chunk-c949b376.js";import"../chunks/chunk-da345742.js";import"../chunks/chunk-41308c4f.js";import"../chunks/chunk-3c838518.js";import"../chunks/chunk-e8bc0b58.js";import"../chunks/chunk-5fc5658a.js";import"../chunks/chunk-9ae07e36.js";import"../chunks/chunk-ce871bab.js";import"../chunks/chunk-255b6daf.js";import"../chunks/chunk-2b326172.js";import"../chunks/chunk-f3107ac8.js";import"../chunks/chunk-a5dd79e5.js";import"../chunks/chunk-63b910cd.js";import"../chunks/chunk-370f01b3.js";import"../chunks/chunk-8c14dae8.js";import"../chunks/chunk-af981888.js";function D({userInfo:n}){const{bookmarkList:t,likeList:s}=n,i=p(c=>c.myListSlice.clicked),o=h();function r(c){var d;const m=(d=c.currentTarget.lastElementChild)==null?void 0:d.innerHTML;typeof m=="string"&&o(S(m))}return e.jsxs("ul",{className:"ul-summary-bookmark",children:[e.jsxs("li",{onClick:r,className:`list-summary-bookmark ${i==="북마크"?"on":""}`,children:[e.jsx("p",{children:n&&t?t.length:0}),e.jsx("p",{children:"북마크"})]}),e.jsxs("li",{onClick:r,className:`list-summary-bookmark ${i==="좋아요"?"on":""}`,children:[e.jsx("p",{children:n&&s?s.length:0}),e.jsx("p",{children:"좋아요"})]})]})}function f({groupInfo:n,lists:t}){const{name:s,registeredAt:i,groupIcon:o}=n,[r]=l.useState(i.slice(0,13)),[c,m]=l.useState(0);return l.useEffect(()=>{if(t.length===0&&m(0),t.length>0){const d=t.filter(a=>a.groupName===s);m(d.length)}},[]),e.jsx("li",{className:"li-bookmarkgroup",children:e.jsx("a",{href:`/my-lists/bookmark/${s}`,children:e.jsxs("div",{className:"style-wrapper-groupname",children:[e.jsxs("div",{className:"style-wrapper-groupname-info",children:[e.jsx("div",{className:"container-groupicon",children:e.jsx("img",{src:o,alt:"그룹 아이콘",style:{width:"100%",height:"100%"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"txt-groupname",children:s}),e.jsxs("p",{className:"txt-restaurant-count",children:["개수 ",e.jsx("span",{className:"num-restaurant-count",children:c})]})]})]}),e.jsx("div",{className:"txt-group-date",children:r})]})})})}function E({lists:n,groupList:t}){const[s,i]=l.useState(null),[o,r]=l.useState(null);l.useEffect(()=>{t&&(i(t),r([...t].sort((a,u)=>a.name.localeCompare(u.name,"en"))))},[t]);const c=p(a=>a.myListSlice.groupNameOrder),m=h();function d(){const a=document.querySelector(".app");a==null||a.classList.add("modal-mode"),m(v(!0))}return t!==null?e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"ul-groupname",children:c==="등록순"?s==null?void 0:s.map(a=>e.jsx(f,{groupInfo:a,lists:n},Math.random())):o==null?void 0:o.map(a=>e.jsx(f,{groupInfo:a,lists:n},Math.random()))}),e.jsx("button",{type:"button",className:"button-new-group",onClick:d,children:"새 그룹 추가"})]}):e.jsxs("div",{className:"style-wrapper-no-review",children:[e.jsx("div",{className:"txt-no-review",children:"🚀"}),e.jsx("p",{children:"로딩중"})]})}function M({lists:n}){const[t,s]=l.useState([]),[i,o]=l.useState([]),[r,c]=l.useState([]);l.useEffect(()=>{(async()=>{const u=[];for(const x of n)try{const j=await d(x._id);u.push(Object.assign(x,j))}catch{console.error("북마크 그룹에 저장된 식당 _id에 대한 정보를 가져오는 데 실패했습니다.")}s(u)})()},[]);const m=p(a=>a.myListSlice.groupNameOrder);l.useEffect(()=>{t.length!==0&&(o(t),c([...t].sort((a,u)=>a.restaurantInfo.title.localeCompare(u.restaurantInfo.title,"en"))))},[t]);async function d(a){return await(await fetch(`${N}/restaurants/${a}`)).json()}return t&&t.length>0?e.jsx("ul",{className:"ul-groupname",children:m==="등록순"?i.map(a=>e.jsx(k,{list:a},Math.random())):r.map(a=>e.jsx(k,{list:a},Math.random()))}):e.jsxs("div",{className:"style-wrapper-no-review",children:[e.jsx("div",{className:"txt-no-review",children:"😭"}),e.jsx("p",{children:"목록이 없어요."})]})}function C({lists:n,groupList:t}){const s=p(c=>c.myListSlice.groupNameOrder),i=h();function o(){const c=document.querySelector(".app");c==null||c.classList.add("modal-mode"),i(g(!0))}function r(){O("/my-lists/bookmark/edit")}return e.jsxs("div",{className:"style-wrapper-bookmark-detail",children:[e.jsxs("div",{className:"wrapper-groupcount-orderbox",children:[e.jsxs("p",{className:"txt-bookmarkgroup",children:["그룹 ",e.jsx("span",{children:(t==null?void 0:t.length)||1})]}),e.jsx("div",{className:"container-order-bookmarkgroup",children:e.jsx("button",{type:"button",className:"button-order-bookmarkgroup",onClick:o,children:s})})]}),e.jsx("button",{type:"button",className:"button-edit-bookmarkgroup",onClick:r,children:"편집하기"})]})}function A({lists:n}){const t=p(r=>r.myListSlice.groupNameOrder),s=h();function i(){const r=document.querySelector(".app");r==null||r.classList.add("modal-mode"),s(g(!0))}function o(){const r=document.querySelector(".app");r==null||r.classList.add("modal-mode"),s(w(!0))}return e.jsxs("div",{className:"style-wrapper-bookmark-detail",children:[e.jsxs("div",{className:"wrapper-groupcount-orderbox",children:[e.jsxs("p",{className:"txt-bookmarkgroup",children:["전체 ",e.jsx("span",{children:n.length})]}),e.jsx("div",{className:"container-order-bookmarkgroup",children:e.jsx("button",{type:"button",className:"button-order-bookmarkgroup",onClick:i,children:t})})]}),e.jsx("button",{type:"button",className:"button-edit-bookmarkgroup",onClick:o,children:"편집하기"})]})}function R({userInfo:n,groupList:t}){const{bookmarkList:s,likeList:i}=n,o=p(r=>r.myListSlice.clicked);return e.jsxs("section",{className:"section-mylists",children:[e.jsx("h3",{className:"sr-only",children:"북마크 또는 좋아요한 식당 목록"}),o==="북마크"?e.jsx(C,{lists:s,groupList:t}):e.jsx(A,{lists:i}),o==="북마크"?e.jsx(E,{lists:s,groupList:t}):e.jsx(M,{lists:i})]})}function re(n){const{isLoggedIn:t,info:s}=n.user,[i,o]=l.useState(null);return l.useEffect(()=>{if(s)try{(async()=>{const c=await(await fetch(`${N}/bookmark/${s==null?void 0:s.userId}`)).json();o(c.groupList)})()}catch(r){console.error(r)}},[s]),e.jsxs(e.Fragment,{children:[e.jsx(b,{title:"내 식당 목록"}),e.jsx(I,{userInfo:s,groupList:i}),e.jsx(y,{isLoggedIn:t}),e.jsx(L,{userInfo:s})]})}function I({userInfo:n,groupList:t}){return e.jsxs("main",{className:"main-bookmark",children:[e.jsx(D,{userInfo:n}),e.jsx(R,{userInfo:n,groupList:t})]})}export{re as Page};
