{"version":3,"file":"chunk-72fd2dbb.js","sources":["../../../../renderer/_hooks/useCheckLoginStatus.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { API_URL } from '../CONSTANT_URL';\r\nimport { UserInfo } from '../../server/models/User';\r\n\r\ntype IsLoggedIn = boolean;\r\ntype User = UserInfo | null;\r\n\r\nexport { useCheckLoginStatus };\r\n\r\nfunction useCheckLoginStatus(): [IsLoggedIn, User] {\r\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n    const [userInfo, setUserInfo] = useState<UserInfo | null>(null);\r\n\r\n    useEffect(() => {\r\n        const checkLoginStatus = async () => {\r\n            try {\r\n                const res = await fetch(`${API_URL}/users/`, {\r\n                    credentials: 'include',\r\n                    method: 'GET',\r\n                });\r\n                const data = (await res.json()) as { success: boolean; user: UserInfo };\r\n                if (data.success === true) {\r\n                    setIsLoggedIn(true);\r\n                    setUserInfo(data.user);\r\n                } else {\r\n                    setIsLoggedIn(false);\r\n                    setUserInfo(null);\r\n\r\n                    if (window.location.pathname === '/my') {\r\n                        window.location.href = '/login';\r\n                    }\r\n\r\n                    if (window.location.pathname === '/my-lists') {\r\n                        window.location.href = '/login';\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                setIsLoggedIn(false);\r\n                setUserInfo(null);\r\n\r\n                if (window.location.pathname === '/my') {\r\n                    window.location.href = '/login';\r\n                }\r\n\r\n                if (window.location.pathname === '/my-lists') {\r\n                    window.location.href = '/login';\r\n                }\r\n            }\r\n        };\r\n\r\n        checkLoginStatus();\r\n    }, []);\r\n\r\n    return [isLoggedIn, userInfo];\r\n}\r\n"],"names":["useCheckLoginStatus","isLoggedIn","setIsLoggedIn","useState","userInfo","setUserInfo","useEffect","data","API_URL"],"mappings":"gFASA,SAASA,GAA0C,CAC/C,KAAM,CAACC,EAAYC,CAAa,EAAIC,WAAS,EAAK,EAC5C,CAACC,EAAUC,CAAW,EAAIF,WAA0B,IAAI,EAE9DG,OAAAA,EAAAA,UAAU,IAAM,EACa,SAAY,CAC7B,GAAA,CAKM,MAAAC,EAAQ,MAJF,MAAM,MAAM,GAAGC,WAAkB,CACzC,YAAa,UACb,OAAQ,KAAA,CACX,GACuB,OACpBD,EAAK,UAAY,IACjBL,EAAc,EAAI,EAClBG,EAAYE,EAAK,IAAI,IAErBL,EAAc,EAAK,EACnBG,EAAY,IAAI,EAEZ,OAAO,SAAS,WAAa,QAC7B,OAAO,SAAS,KAAO,UAGvB,OAAO,SAAS,WAAa,cAC7B,OAAO,SAAS,KAAO,iBAI/BH,EAAc,EAAK,EACnBG,EAAY,IAAI,EAEZ,OAAO,SAAS,WAAa,QAC7B,OAAO,SAAS,KAAO,UAGvB,OAAO,SAAS,WAAa,cAC7B,OAAO,SAAS,KAAO,SAE/B,CAAA,IAIR,EAAG,CAAE,CAAA,EAEE,CAACJ,EAAYG,CAAQ,CAChC"}