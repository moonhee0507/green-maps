import{r as n,j as c}from"./chunk-0ad0329c.js";import{a as E,b as e,A as i,B as f}from"./chunk-0fac4abb.js";import"./chunk-da345742.js";import{e as h}from"./chunk-8da5e704.js";function m(){const o=E(),s=e(t=>t.postSlice.editMode),r=e(t=>t.postSlice.postId),l=e(t=>t.postSlice.SUBJECT),p=e(t=>t.postSlice.NICKNAME),d=e(t=>t.postSlice.TITLE),u=e(t=>t.postSlice.CONTENT),a=n.useCallback(async()=>(await(await fetch(`${i}/users/`,{credentials:"include",method:"GET"})).json()).user,[]);n.useEffect(()=>{a().then(t=>{t?o({type:"postSlice/OWNER_STATE",NICKNAME:t.nickName}):console.log("사용자 정보가 없습니다. 로그인 하세요.")})},[a]);async function S(){try{const t={subject:l,owner:p,title:d,content:u};(await(await fetch(`${i}/posts/${s?r:""}`,{credentials:"include",method:s?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()).success?alert("게시글이 등록되었습니다."):alert("다시 시도해주세요.")}catch(t){console.error(t)}finally{o({type:"postSlice/SUBJECT_STATE",SUBJECT:""}),o(h(!1)),history.back()}}return c.jsx("button",{type:"button",onClick:S,children:"등록"})}function x(o){const[s]=n.useState(o.title);return c.jsxs("div",{className:"top-bar",children:[c.jsx(f,{}),c.jsx("h2",{className:"top-title",children:s}),s==="글 쓰기"||s==="글 수정"?c.jsx(m,{}):null]})}export{x as T};
