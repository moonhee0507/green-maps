import{r,j as e}from"./chunk-0ad0329c.js";import"./chunk-da345742.js";import{a as k,A as m,b as x,c as v}from"./chunk-0fac4abb.js";import{n as h}from"./chunk-c949b376.js";import{i as N}from"./chunk-9ae07e36.js";import{S}from"./chunk-32ec8ef6.js";import{R as g}from"./chunk-53b3a789.js";import{P as E}from"./chunk-1b57fcb1.js";import"./chunk-af981888.js";import"./chunk-dfbf6de9.js";import"./chunk-2b326172.js";import"./chunk-41308c4f.js";const C="/images/icon-bookmark.svg";function _({restaurantId:s,isLoggedIn:t}){const n=k(),a=r.useCallback(async()=>{if(t)return(await(await fetch(`${m}/users/`,{credentials:"include",method:"GET"})).json()).user.bookmarkList.some(d=>s===d._id)},[s,t]),c=r.useCallback(async()=>{t&&((await fetch(`${m}/users/bookmark/${s}`,{credentials:"include",method:"DELETE"})).ok?n({type:"buttonSlice/HAS_BOOKMARK_LIST",ON:!1}):console.error("ë¶ë§ˆí¬ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."))},[s,t]);r.useEffect(()=>{a().then(i=>{n({type:"buttonSlice/HAS_BOOKMARK_LIST",ON:i})})},[a,t]);function u(){t?a().then(i=>i?c():o()):confirm(`ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ìž…ë‹ˆë‹¤.
ë¡œê·¸ì¸ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)&&h("/login")}async function o(){try{if((await fetch(`${m}/users/bookmark`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:s})})).ok)n({type:"buttonSlice/HAS_BOOKMARK_LIST",ON:!0});else throw new Error}catch(i){console.error(i)}}return e.jsxs("button",{className:"button-bookmark",onClick:u,type:"button",children:[e.jsx("img",{src:C,alt:"ë¶ë§ˆí¬ ì´ë¯¸ì§€",className:x(i=>i.buttonSlice.bookmark.ON?"img-bookmark on":"img-bookmark")}),e.jsx("span",{className:"txt-bookmark",children:"ë¶ë§ˆí¬"})]})}function O({restaurantId:s,isLoggedIn:t}){const n=k(),a=r.useCallback(async()=>{if(t)return(await(await fetch(`${m}/users/`,{credentials:"include",method:"GET"})).json()).user.likeList.some(d=>s===d._id)},[s,t]),c=r.useCallback(async()=>{(await fetch(`${m}/users/like/${s}`,{credentials:"include",method:"DELETE"})).ok?n({type:"buttonSlice/HAS_LIKE_LIST",ON:!1}):console.error("ì¢‹ì•„ìš” ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")},[s,t]);r.useEffect(()=>{a().then(i=>{n({type:"buttonSlice/HAS_LIKE_LIST",ON:i})})},[a,t]);function u(){t?a().then(i=>i?c():o()):confirm(`ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ìž…ë‹ˆë‹¤.
ë¡œê·¸ì¸ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)&&h("/login")}async function o(){try{if((await fetch(`${m}/users/like`,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:s})})).ok)n({type:"buttonSlice/HAS_LIKE_LIST",ON:!0});else throw new Error}catch(i){console.error(i)}}return e.jsxs("button",{className:"button-like",onClick:u,type:"button",children:[e.jsx("img",{src:N,alt:"ì¢‹ì•„ìš” ì´ë¯¸ì§€",className:x(i=>i.buttonSlice.like.ON?"img-like on":"img-like")}),e.jsx("span",{className:"txt-like",children:"ì¢‹ì•„ìš”"})]})}const T="/images/icon-share.svg";function R(){const s=()=>{alert("ì¤€ë¹„ ì¤‘ì¸ ì„œë¹„ìŠ¤ìž…ë‹ˆë‹¤.")};return e.jsxs("button",{className:"button-share",onClick:s,type:"button",children:[e.jsx("img",{src:T,alt:"ê³µìœ í•˜ê¸° ì´ë¯¸ì§€",className:"img-share"}),e.jsx("span",{className:"txt-share",children:"ê³µìœ í•˜ê¸°"})]})}function L({restaurantId:s,isLoggedIn:t}){return e.jsxs("div",{className:"container-bookmark-like-share",children:[e.jsx(_,{restaurantId:s,isLoggedIn:t}),e.jsx(O,{restaurantId:s,isLoggedIn:t}),e.jsx(R,{})]})}const B="/images/icon-copy.svg";function j(s){const t=()=>{window.navigator.clipboard.writeText(s.address),alert("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")};return e.jsxs("button",{type:"button",onClick:t,children:[e.jsx("img",{src:B,alt:"ì£¼ì†Œ ë³µì‚¬ ì•„ì´ì½˜",className:"img-copy"}),e.jsx("span",{style:{fontSize:"13px"},children:"ë³µì‚¬"})]})}function A(s){return e.jsxs("div",{children:[s.cert?e.jsx("div",{className:"restaurant-cert",children:s.cert}):null,e.jsx("div",{className:"restaurant-category",children:s.category}),e.jsx("h3",{className:"txt-restaurant-title",children:s.title}),e.jsxs("div",{children:[e.jsxs("span",{className:"txt-restaurant-address",children:[s.address," "]}),e.jsx(j,{address:s.address})]})]})}function P({restaurantInfo:s,isLoggedIn:t}){const[n,a]=r.useState(null);return r.useEffect(()=>{s!==null&&a(s)},[s]),n?e.jsxs("section",{className:"section-primary",children:[e.jsx(A,{title:n.title,address:n.address,category:n.category,cert:n.certification}),e.jsx(S,{rating:n.rating}),e.jsx(L,{restaurantId:n._id,isLoggedIn:t})]}):e.jsxs("div",{className:"style-wrapper-no-review",children:[e.jsx("div",{className:"txt-no-review",children:"ðŸ˜­"}),e.jsx("p",{children:"ëª©ë¡ì´ ì—†ì–´ìš”."})]})}function $({restaurantInfo:s}){return r.useEffect(()=>{if(s!==null){const{kakao:n}=window,[a,c]=s.location.coordinates,u=document.getElementById("miniMap"),o={center:new n.maps.LatLng(c,a),level:3},i=new n.maps.Map(u,o);var t=new n.maps.Marker({position:new n.maps.LatLng(c,a)});t.setMap(i)}},[]),e.jsxs("section",{className:"section-location",children:[e.jsx("h4",{className:"sr-only",children:"ìœ„ì¹˜"}),e.jsxs("div",{className:"style-wrapper-location-address",children:[e.jsxs("span",{children:[s!==null?s.address:""," "]}),e.jsx(j,{address:s!==null?s.address:""})]}),e.jsx("div",{id:"miniMap"})]})}function K({restaurantId:s,isLoggedIn:t}){function n(){t?h(`/search/${s}/reviews/create`):confirm(`ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ìž…ë‹ˆë‹¤.
ë¡œê·¸ì¸ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)&&h("/login")}return e.jsx("div",{className:"style-container-write-review",children:e.jsx("button",{type:"button",onClick:n,className:"styled-button",children:"ë¦¬ë·° ìž‘ì„±í•˜ê¸°"})})}function M({reviews:s,userInfo:t,restaurantId:n}){return e.jsx("div",{className:"wrapper-review",children:s&&s.length>0?e.jsx("ul",{children:s.map((a,c)=>e.jsx(g,{item:a,userInfo:t,restaurantId:n,isFirst:c===0},c))}):e.jsxs("div",{className:"style-wrapper-no-review",children:[e.jsx("div",{className:"txt-no-review",children:"ðŸ˜­"}),e.jsx("p",{children:"ë¦¬ë·°ê°€ ì•„ì§ ì—†ì–´ìš”."})]})})}function H({restaurantInfo:s,isLoggedIn:t,userInfo:n}){const{_id:a,reviews:c}=s,u=v(),o=x(l=>l.paginationSlice.currentPage),[i,p]=r.useState(0),[d,f]=r.useState(null);r.useEffect(()=>{u({type:"paginationSlice/CURRENT_PAGE",currentPage:1})},[s]);const w=r.useCallback(async()=>await(await fetch(`${m}/restaurants/${a}/reviews`)).json(),[s]),y=r.useCallback(async()=>await(await fetch(`${m}/restaurants/${a}?page=${o}`)).json(),[o]);return r.useEffect(()=>{w().then(l=>{l.success&&p(l.reviews.total)}),y().then(l=>{l.success&&f(l.restaurantInfo.reviews)})},[s,o]),e.jsxs("section",{className:"section-review",children:[e.jsx("h4",{className:"sr-only",children:"ë¦¬ë·°"}),e.jsx(K,{restaurantId:a,isLoggedIn:t}),e.jsx(M,{reviews:d,userInfo:n,restaurantId:a}),c&&c.length>0&&e.jsx(E,{count:i,perPage:5})]})}function Z({restaurantInfo:s,isLoggedIn:t,userInfo:n}){return e.jsx("main",{className:"wrapper-restaurant-detail",children:s?e.jsxs(e.Fragment,{children:[e.jsx(P,{restaurantInfo:s,isLoggedIn:t}),e.jsx($,{restaurantInfo:s}),e.jsx(H,{restaurantInfo:s,isLoggedIn:t,userInfo:n})]}):null})}export{Z as default};
