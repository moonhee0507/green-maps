import{j as t,r as o}from"./chunk-0ad0329c.js";import{b as p,u as r,A as h}from"./chunk-f5cf074f.js";import{k as L,e as f,c as R,p as j,C as y,q as I,r as b}from"./chunk-a0776c37.js";import{a as x}from"./chunk-3258e6a6.js";import{i as A,c as N,s as E,o as M,a as _,m as O}from"../entries/pages_search_index.page.62c72ab5.js";import{c as k}from"./chunk-8ece9c5d.js";import"./chunk-da345742.js";import"./chunk-8da5e704.js";import"./chunk-101896b7.js";import"./chunk-621f058a.js";import"./chunk-bf08ca9a.js";import"./chunk-eb9ca642.js";import"./chunk-e4242990.js";import"./chunk-0defb547.js";import"./chunk-035a7463.js";import"./chunk-d64dca2b.js";import"./chunk-4c6e2a54.js";import"./chunk-371787c9.js";import"./chunk-32ec8ef6.js";import"./chunk-0249643f.js";import"./chunk-8275f212.js";import"./chunk-e8bc0b58.js";import"./chunk-5b1b7faa.js";import"./chunk-3c838518.js";import"./chunk-aaa4175a.js";import"./chunk-c9eff144.js";import"./chunk-1591098a.js";function T(){return t.jsxs("div",{className:"wrapper-map-control-button",children:[t.jsxs("div",{className:"container-button-map-mode",children:[t.jsx(D,{}),t.jsx(v,{})]}),t.jsx("div",{children:t.jsx(w,{})})]})}function w(){const n=p(),i=r(a=>a.mapSlice.showListInRegionModalOn),s=()=>{n(L(!0)),i===!0&&n(f(!1))};return t.jsx("button",{type:"button",onClick:s,children:"업종 필터"})}function v(){const n=p(),i=r(a=>a.mapSlice.mapMode);function s(){x(!0),n(R(!0)),n(f(!1)),n(j("지역탐색 모드"))}return t.jsx("button",{onClick:s,className:`button-map-mode ${i==="지역탐색 모드"?"on":""}`,children:"지역 탐색 모드"})}function D(){const n=p(),i=r(l=>l.mapSlice.mapMode),s=r(l=>l.mapSlice.radius),[a,m]=o.useState(s),[c,d]=o.useState("m");o.useEffect(()=>{s<1e3?(m(s),d("m")):(m(s/1e3),d("km"))},[s]);const u=()=>{x(!0),n(y(!0)),n(j("반경탐색 모드"))};return t.jsxs("button",{type:"button",onClick:u,className:`button-map-mode ${i==="반경탐색 모드"?"on":""}`,children:[t.jsx("span",{children:"반경 "}),t.jsx("span",{children:a}),t.jsx("span",{children:c}),t.jsx("span",{children:" 탐색 모드"})]})}function $({isLoggedIn:n}){const i=p(),s=r(e=>e.mapSlice.radius),[a,m]=o.useState(!1),[c,d]=o.useState(null),u=r(e=>e.mapSlice.selectedCategory);o.useEffect(()=>{_(n),A().then(e=>{m(!0),d([e.getLng(),e.getLat()])})},[]);const l=o.useCallback(async e=>{if(Array.isArray(e))return await(await fetch(`${h}/map/within-radius-of?radius=${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentLocation:e,category:u})})).json()},[s,u,c]),S=o.useCallback(async e=>{if(Array.isArray(e))return await(await fetch(`${h}/map/nearest?top=5`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentLocation:e})})).json()},[s,c]);return o.useEffect(()=>{a&&(N(),E(s),c&&(l(c).then(e=>{e.success&&(i(I(e.lists)),M(s))}),S(c).then(e=>{e.success&&i(b(e.lists))})))},[s,a,u,c]),t.jsx("div",{id:"map"})}function G(){const n=p(),i=()=>{O(),n(f(!1))};return t.jsx("button",{type:"button",onClick:i,className:"button-move-to-my",title:"내 위치로","aria-label":"내 위치로 이동 버튼"})}function U(){const n=r(a=>a.mapSlice.currentSido),i=r(a=>a.mapSlice.currentSigungu),s=r(a=>a.mapSlice.resultInRadius);return s.length>0?t.jsxs("p",{className:"txt-result-in-radius",children:["내 위치(",`${n} ${i}`,")에 검색된 식당 ",t.jsx("span",{children:s.length}),"개"]}):t.jsxs("p",{className:"txt-result-in-radius",children:["결과가 없어요!😥",t.jsx("br",{}),"가장 가까운 식당 TOP 5"]})}function P(){return t.jsxs("div",{className:"wrapper-result-in-radius",children:[t.jsx(U,{}),t.jsx(k,{})]})}function ht({isLoggedIn:n}){return t.jsxs("main",{className:"main-map",children:[t.jsx(T,{}),t.jsx($,{isLoggedIn:n}),t.jsx(G,{}),t.jsx(P,{})]})}export{ht as default};
