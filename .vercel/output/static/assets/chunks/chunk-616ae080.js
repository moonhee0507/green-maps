import{r as l,j as e}from"./chunk-0ad0329c.js";import{u as p,a as h,A as j}from"./chunk-3185794e.js";import{b as G,O as v,c as b,A as M,I as O,d as T,P as D,e as $,f as _,M as L,C,R as g,g as k,D as A}from"./chunk-dcab5b34.js";import{i as N}from"./chunk-e8bc0b58.js";import{I as B}from"./chunk-bc1c2bba.js";import{n as P}from"./chunk-c949b376.js";import{s as U}from"./chunk-8756e824.js";import{D as q}from"./chunk-2a426ce7.js";function F(){const t=p(),s=h(a=>a.myListSlice.groupNameOrder),n=h(a=>a.myListSlice.orderModalOn),[r,c]=l.useState(!1);l.useEffect(()=>{c(n===!0)},[n]);function d(a){t(G(a.currentTarget.innerText)),o()}function o(){const a=document.querySelector(".app");a==null||a.classList.remove("modal-mode"),t(v(!1))}return e.jsxs("article",{className:`modal-group-item ${r?"on":""}`,children:[e.jsx("h4",{children:"Ï†ïÎ†¨Í∏∞Ï§Ä"}),e.jsxs("div",{className:"container-button",children:[e.jsx("button",{type:"button",onClick:d,className:`button-groupname-order ${s==="Îì±Î°ùÏàú"?"on":""}`,children:"Îì±Î°ùÏàú"}),e.jsx("button",{type:"button",onClick:d,className:`button-groupname-order ${s==="Ïù¥Î¶ÑÏàú"?"on":""}`,children:"Ïù¥Î¶ÑÏàú"})]}),e.jsx("button",{type:"button",className:"button-close",onClick:o,children:e.jsx("img",{src:N,alt:"X ÏïÑÏù¥ÏΩò",className:"img-close"})})]})}function H(){const t=p(),s=h(d=>d.myListSlice.groupName),[n,r]=l.useState("");l.useEffect(()=>{s===""&&r("")},[s]);function c(d){r(d.target.value),t(b(d.target.value))}return e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"groupName",className:"sr-only",children:"Í∑∏Î£πÎ™Ö"}),e.jsx("input",{type:"text",id:"groupName",placeholder:"Í∑∏Î£πÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥ Ï£ºÏÑ∏Ïöî.",maxLength:20,minLength:1,onChange:c,value:n})]})}function X({userInfo:t}){const[s,n]=l.useState({disabled:!0}),r=h(o=>o.myListSlice.groupName),c=h(o=>o.myListSlice.selectedIcon);l.useEffect(()=>{r!==null?r.length!==0?n({disabled:!1}):n({disabled:!0}):n({disabled:!0})},[r]);async function d(){if(t!==null){const{userId:o}=t,u=await(await fetch(`${j}/bookmark/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:o,name:r,groupIcon:c})})).json();console.log(u),u.success===!0?window.location.reload():alert("Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.")}else alert(`Î°úÍ∑∏ÏïÑÏõÉ ÎêòÏóàÏäµÎãàÎã§.
Îã§Ïãú Î°úÍ∑∏Ïù∏Ìï¥Ï£ºÏÑ∏Ïöî.`),P("/login")}return e.jsx("button",{type:"button",className:`button-groupname-complete ${s?"on":""}`,onClick:d,children:"ÏôÑÎ£å"})}function K({userInfo:t}){const s=p(),n=h(o=>o.myListSlice.addGroupModalOn),[r,c]=l.useState(!1);l.useEffect(()=>{c(n===!0)},[n]);function d(){const o=document.querySelector(".app");o==null||o.classList.remove("modal-mode"),s(M(!1)),s(b("")),s(O("/images/icon-star.svg"))}return e.jsxs("article",{className:`modal-group-item ${r?"on":""}`,children:[e.jsx("h4",{children:"ÏÉà Í∑∏Î£π Ï∂îÍ∞Ä"}),e.jsxs("form",{children:[e.jsx(H,{}),e.jsx(B,{}),e.jsx(X,{userInfo:t})]}),e.jsx("button",{type:"button",className:"button-close",onClick:d,children:e.jsx("img",{src:N,alt:"X ÏïÑÏù¥ÏΩò",className:"img-close"})})]})}function V({bookmarkList:t}){return e.jsx("div",{children:t.length>0?t.map(s=>e.jsx(J,{list:s._id},Math.random())):e.jsxs("div",{className:"style-wrapper-no-review",children:[e.jsx("div",{className:"txt-no-review",children:"üò≠"}),e.jsx("p",{children:"Î™©Î°ùÏù¥ ÏóÜÏñ¥Ïöî."})]})})}function J({list:t}){const s=p(),{_id:n,title:r,address:c,category:d}=t,[o,a]=l.useState(!1),u=h(i=>i.myListSlice.restaurantToMove);l.useEffect(()=>{},[]);const m=i=>{if(a(i.target.checked),i.target.checked)s(T(1)),s(D([...u,n]));else{s($(1));const f=[...u],x=f.indexOf(n);f.splice(x,1),s(_(f))}};return e.jsxs("label",{className:"label-bookmarklist",children:[e.jsx("input",{type:"checkbox",className:"checkbox-bookmarklist",checked:o,onChange:m}),e.jsx("div",{className:"wrapper-bookmarklist-edit",children:e.jsxs("dl",{children:[e.jsxs("dl",{className:"container-title-category",children:[e.jsx("dt",{className:"sr-only",children:"ÏãùÎãπ Ïù¥Î¶Ñ"}),e.jsx("dd",{className:"txt-title",children:r}),e.jsx("dt",{className:"sr-only",children:"ÏóÖÏ¢Ö"}),e.jsx("dd",{className:"txt-category",children:d})]}),e.jsxs("dl",{children:[e.jsx("dt",{className:"sr-only",children:"Ï£ºÏÜå"}),e.jsx("dd",{className:"txt-address",children:c})]})]})})]})}function W(){const t=p(),s=h(a=>a.myListSlice.countChecked),n=h(a=>a.myListSlice.restaurantToMove);function r(){t(L(!1)),t(C(!0))}async function c(){if(n.length>0){const a=n.map(u=>d(u));try{const u=await Promise.all(a);u.forEach((m,i)=>{i===u.length-1&&window.location.reload()})}catch(u){console.error("ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",u)}}}async function d(a){return await(await fetch(`${j}/users/bookmark/${a}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).json()}function o(){t(g()),t(k([]))}return e.jsxs("div",{className:"container-button-move",children:[e.jsx("button",{type:"reset",onClick:o,children:"ÏÑ†ÌÉù Ìï¥Ï†ú"}),e.jsxs("button",{type:"button",onClick:r,disabled:!s,children:[e.jsx("span",{className:"txt-copy-del",children:"Î≥µÏÇ¨"}),e.jsx("span",{children:s})]}),e.jsxs("button",{type:"button",disabled:!s,onClick:c,children:[e.jsx("span",{className:"txt-copy-del",children:"ÏÇ≠Ï†ú"}),e.jsx("span",{children:s})]})]})}function Y({userInfo:t}){const[s,n]=l.useState(!1),[r,c]=l.useState([]),d=h(u=>u.myListSlice.moveListModalOn);l.useEffect(()=>{n(d===!0)},[d]);const o=h(u=>u.myListSlice.targetGroup);l.useEffect(()=>{t!==null&&a().then(u=>{if(u.success){const m=U.getState().myListSlice.targetGroup,i=u.bookmarkList.filter(f=>f.groupName===m);c(i)}})},[o]);async function a(){return await(await fetch(`${j}/users/bookmark`)).json()}return e.jsxs("article",{className:`modal-group-item ${s?"on":""}`,children:[e.jsx("h4",{children:"Î™©Î°ù Ìé∏Ïßë"}),e.jsx(z,{bookmarkList:r}),e.jsx(Q,{})]})}function z({bookmarkList:t}){return e.jsxs("form",{children:[e.jsx(V,{bookmarkList:t}),e.jsx(W,{})]})}function Q(){const t=p();function s(){const n=document.querySelector(".app");n==null||n.classList.remove("modal-mode"),t(L(!1)),t(g()),t(k([]))}return e.jsx("button",{type:"button",className:"button-close",onClick:s,children:e.jsx("img",{src:N,alt:"X ÏïÑÏù¥ÏΩò",className:"img-close"})})}function Z({userInfo:t,groupInfo:s,lists:n}){const{name:r,registeredAt:c,groupIcon:d}=s,[o]=l.useState(c.slice(0,13)),[a,u]=l.useState(0),[m,i]=l.useState(null);l.useEffect(()=>{if(n.length===0&&u(0),n.length>0){const y=n.filter(S=>S.groupName===r);u(y.length)}t!==null&&i(t)},[]);const f=h(y=>y.myListSlice.restaurantToMove);function x(){m!==null&&R(m.userId,r,f)}async function R(y,S,I){const w=await(await fetch(`${j}/users/update/bookmark`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:y,newGroupName:S,selectedRestaurant:I})})).json();w.success?(alert(`Î≥µÏÇ¨Í∞Ä ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.
Î≥µÏÇ¨Í∞Ä ÏôÑÎ£åÎêú ÏõêÎ≥∏ÏùÄ ÏÇ≠Ï†úÎê©ÎãàÎã§.`),window.location.href="/my-lists"):console.error(w)}return e.jsx("li",{className:"li-bookmarkgroup copy",children:e.jsx("button",{onClick:x,children:e.jsxs("div",{className:"style-wrapper-groupname",children:[e.jsxs("div",{className:"style-wrapper-groupname-info",children:[e.jsx("div",{className:"container-groupicon",children:e.jsx("img",{src:d,alt:"Í∑∏Î£π ÏïÑÏù¥ÏΩò"})}),e.jsxs("div",{children:[e.jsx("p",{className:"txt-groupname",children:r}),e.jsxs("p",{className:"txt-restaurant-count",children:["Í∞úÏàò ",e.jsx("span",{className:"num-restaurant-count",children:a})]})]})]}),e.jsx("div",{className:"txt-group-date",children:o})]})})})}function ee(){const t=p();function s(){t(C(!1)),t(L(!0)),t(g()),t(k([]))}return e.jsx("button",{type:"button",className:"button-close",onClick:s,children:e.jsx("img",{src:N,alt:"X ÏïÑÏù¥ÏΩò",className:"img-close"})})}function te({userInfo:t}){const s=h(i=>i.myListSlice.copyModalOn),n=h(i=>i.myListSlice.targetGroup),[r,c]=l.useState(!1),[d,o]=l.useState([]),[a,u]=l.useState([]);l.useEffect(()=>{c(s===!0)},[s]),l.useEffect(()=>{t!==null&&(m(t.userId).then(i=>{i.success&&o(i.groupList)}),u(t.bookmarkList))},[]);async function m(i){return await(await fetch(`${j}/bookmark/${i}`)).json()}return e.jsxs("article",{className:`modal-group-item ${r?"on":""}`,children:[e.jsx("h4",{children:"Î≥µÏÇ¨Ìï† Í∑∏Î£π ÏÑ†ÌÉù"}),e.jsx("ul",{className:"ul-groupname",children:d.filter(i=>i.name!==n).map(i=>e.jsx(Z,{groupInfo:i,lists:a,userInfo:t},Math.random()))}),e.jsx(ee,{})]})}function ge({userInfo:t}){const s=h(o=>o.myListSlice.orderModalOn||o.myListSlice.addGroupModalOn||o.myListSlice.moveListModalOn||o.myListSlice.copyModalOn||o.myListSlice.deleteLikeListModalOn),[n,r]=l.useState(!1),c=p();l.useEffect(()=>{r(s===!0)},[s]),l.useEffect(()=>(n&&document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}),[n]);function d(o){if(o.target.className==="app modal-mode"){const a=document.querySelector(".app");a==null||a.classList.remove("modal-mode"),c(v(!1)),c(M(!1)),c(L(!1)),c(C(!1)),c(A(!1)),c(b("")),c(O("/images/icon-star.svg")),c(g()),c(k([]))}}return e.jsxs("div",{className:`modal-group ${n?"on":""}`,children:[e.jsx(F,{}),e.jsx(K,{userInfo:t}),e.jsx(Y,{userInfo:t}),e.jsx(te,{userInfo:t}),e.jsx(se,{userInfo:t})]})}function se({userInfo:t}){const[s,n]=l.useState(!1),[r,c]=l.useState([]),d=h(a=>a.myListSlice.deleteLikeListModalOn);l.useEffect(()=>{n(!!d)},[d]),l.useEffect(()=>{t!==null&&o().then(a=>{a.success&&c(a.likeList)})},[t]);async function o(){return await(await fetch(`${j}/users/like`)).json()}return e.jsxs("article",{className:`modal-group-item ${s?"on":""}`,children:[e.jsx("h4",{children:"Î™©Î°ù ÏÇ≠Ï†ú"}),e.jsx(ne,{likeList:r}),e.jsx(ae,{})]})}function ne({likeList:t}){return e.jsxs("form",{children:[e.jsx(oe,{likeList:t}),e.jsx(re,{})]})}function ae(){const t=p();function s(){const n=document.querySelector(".app");n==null||n.classList.remove("modal-mode"),t(A(!1)),t(g()),t(k([]))}return e.jsx("button",{type:"button",className:"button-close",onClick:s,children:e.jsx("img",{src:N,alt:"X ÏïÑÏù¥ÏΩò",className:"img-close"})})}function oe({likeList:t}){return e.jsx("div",{children:t.length>0?t.map(s=>e.jsx(ce,{list:s._id},Math.random())):e.jsxs("div",{className:"style-wrapper-no-review",children:[e.jsx("div",{className:"txt-no-review",children:"üò≠"}),e.jsx("p",{children:"Î™©Î°ùÏù¥ ÏóÜÏñ¥Ïöî."})]})})}function ce({list:t}){const s=p(),{_id:n,title:r,address:c,category:d}=t,[o,a]=l.useState(!1),u=h(i=>i.myListSlice.restaurantToMove),m=i=>{if(a(i.target.checked),i.target.checked)s(T(1)),s(D([...u,n]));else{s($(1));const f=[...u],x=f.indexOf(n);f.splice(x,1),s(_(f))}};return e.jsxs("label",{className:"label-bookmarklist",children:[e.jsx("input",{type:"checkbox",className:"checkbox-bookmarklist",checked:o,onChange:m}),e.jsx("div",{className:"wrapper-bookmarklist-edit",children:e.jsxs("dl",{children:[e.jsxs("dl",{className:"container-title-category",children:[e.jsx("dt",{className:"sr-only",children:"ÏãùÎãπ Ïù¥Î¶Ñ"}),e.jsx("dd",{className:"txt-title",children:r}),e.jsx("dt",{className:"sr-only",children:"ÏóÖÏ¢Ö"}),e.jsx("dd",{className:"txt-category",children:d})]}),e.jsxs("dl",{children:[e.jsx("dt",{className:"sr-only",children:"Ï£ºÏÜå"}),e.jsx("dd",{className:"txt-address",children:c})]})]})})]})}function re(){const t=p(),s=h(o=>o.myListSlice.countChecked),n=h(o=>o.myListSlice.restaurantToMove);async function r(){if(n.length>0){const o=n.map(a=>c(a));try{const a=await Promise.all(o);a.forEach((u,m)=>{m===a.length-1&&window.location.reload()})}catch(a){console.error("ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",a)}}}async function c(o){return await(await fetch(`${j}/users/like/${o}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).json()}function d(){t(g()),t(k([]))}return e.jsxs("div",{className:"container-button-move like",children:[e.jsx("button",{type:"reset",onClick:d,children:"ÏÑ†ÌÉù Ìï¥Ï†ú"}),e.jsxs("button",{type:"button",disabled:!s,onClick:r,children:[e.jsx("span",{className:"txt-copy-del",children:"ÏÇ≠Ï†ú"}),e.jsx("span",{children:s})]})]})}function le({restaurantId:t,restaurantTitle:s}){const[n,r]=l.useState(!1),c=l.useRef(null),d=h(m=>m.myListSlice.clicked);function o(){r(m=>!m)}l.useEffect(()=>(n&&window.addEventListener("click",a),()=>{window.addEventListener("click",a)}),[n]);function a(m){const i=m.target;c.current&&!c.current.contains(i)&&r(!1)}async function u(){try{const m=d==="Î∂ÅÎßàÌÅ¨"?"bookmark":"like";confirm("Ìï¥Îãπ ÏãùÎãπÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?")?(await(await fetch(`${j}/users/${m}/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).json()).success?(alert(`${s} ÏÇ≠Ï†úÍ∞Ä ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.`),window.location.reload()):alert("Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî."):r(!1)}catch(m){console.error(m)}}return e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button","aria-label":"ÎçîÎ≥¥Í∏∞ Î≤ÑÌäº",className:"button-more",onClick:o,ref:c}),n&&e.jsx("div",{className:"container-more-option",children:e.jsx("ul",{children:e.jsx("li",{className:"list-option",onClick:u,children:e.jsx("div",{children:e.jsx("p",{className:"txt-delete",children:"ÏÇ≠Ï†ú"})})})})})]})}function ke({lists:t}){const[s,n]=l.useState([]),[r,c]=l.useState([]),[d,o]=l.useState([]);l.useEffect(()=>{(async()=>{const i=[];for(const f of t)try{const x=await u(f._id);i.push(Object.assign(f,x))}catch{console.error("Î∂ÅÎßàÌÅ¨ Í∑∏Î£πÏóê Ï†ÄÏû•Îêú ÏãùÎãπ _idÏóê ÎåÄÌïú Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.")}n(i)})()},[]);const a=h(m=>m.myListSlice.groupNameOrder);l.useEffect(()=>{s.length!==0&&(c(s),o([...s].sort((m,i)=>m.restaurantInfo.title.localeCompare(i.restaurantInfo.title,"en"))))},[s]);async function u(m){return await(await fetch(`${j}/restaurants/${m}`)).json()}return s&&s.length>0?e.jsx("ul",{className:"ul-groupname",children:a==="Îì±Î°ùÏàú"?r.map(m=>e.jsx(E,{list:m},Math.random())):d.map(m=>e.jsx(E,{list:m},Math.random()))}):e.jsxs("div",{className:"style-wrapper-no-review",children:[e.jsx("div",{className:"txt-no-review",children:"üò≠"}),e.jsx("p",{children:"Î™©Î°ùÏù¥ ÏóÜÏñ¥Ïöî."})]})}function E({list:t}){const{_id:s,title:n,location:r,address:c}=t.restaurantInfo;return e.jsxs("li",{className:"list-restaurant-inbookmark",children:[e.jsx("a",{href:`/search/${s}`,children:e.jsxs("div",{className:"container-restaurant-title-detail",children:[e.jsxs("div",{className:"style-container-title-date",children:[e.jsx("p",{className:"txt-title",children:n}),e.jsx("span",{className:"txt-date",children:t.registeredAt.slice(0,13)})]}),e.jsxs("div",{children:[e.jsx(q,{location:r.coordinates||[0,0]}),e.jsx("span",{className:"txt-address",children:c})]})]})}),e.jsx(le,{restaurantId:s,restaurantTitle:n})]})}export{ke as B,E as L,ge as M};
